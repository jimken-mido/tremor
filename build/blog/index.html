<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Blog | Tremor</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.tremor.rs/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | Tremor"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/static/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.tremor.rs/blog"><link data-rh="true" rel="alternate" href="https://www.tremor.rs/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.tremor.rs/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Tremor RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Tremor Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8fde9d3c.css">
<link rel="preload" href="/assets/js/runtime~main.0a24082e.js" as="script">
<link rel="preload" href="/assets/js/main.fe542851.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.tremor.rs/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/tremor-logo.svg" alt="Tremor Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docs/0.12/getting-started/">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" positition="left" href="/docs/0.12">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/0.12/guides/">Guides</a></li><li><a class="dropdown__link" href="/docs/0.12/reference/">Reference Documentation</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/0.12/">0.12</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/edge/">edge</a></li><li><a class="dropdown__link" href="/docs/0.12/">0.12</a></li><li><a class="dropdown__link" href="/docs/0.11/">0.11</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-0.12,docs-rfc-current"></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/09/24/LFX-Blog-Carol">Hygienic error handling and validation for pipelines</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/07/LFX-Blog-Sasha">Support for the ClickHouse database in Tremor</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/06/15/tdengine-colaboration">TDengine colaboration</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/06/03/LFX-Blog-Prashant">Automating the tremor release process</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/06/02/tremor-tremors">Tremors - May &#x27;22</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/09/24/LFX-Blog-Carol">Hygienic error handling and validation for pipelines</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-09-24T00:00:00.000Z" itemprop="datePublished">September 24, 2022</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/carolgeng/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Carol Geng</span></a></div><small class="avatar__subtitle" itemprop="description">Tremor 2022 Summer Mentee</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>Hello, my name&#x27;s Carol Geng, a current sophomore pursuing a Bachelor&#x27;s degree in Computer Science at Texas A&amp;M University. Over Summer 2022, I have contributed to Tremor as part of the LFX Mentorship Program with my mentors Heinz Gies and Matthias Wahl, and this blog will show how valuable and enjoyable the experience was.</p><h1>About the Project</h1><p>Tremor is an event processing engine that uses pipelines and connectors for data to be passed through. However, errors could be made by the user when linking the ports of the pipelines, and those errors are not easily displayed to the user. There were cases where the location of the error wasn’t printed, nothing was printed at all, or even cases where the program would work as if everything was all fine. My mentorship project was focused on creating the messages that would be displayed to the user in a clear and concise manner through the console.</p><h1>The Mentorship Journey</h1><p>Before this mentorship, I had only worked in open-source a few times on projects and had no knowledge of how to code in Rust. This mentorship therefore allowed me to build on what I already knew while also giving me an opportunity to learn a new language. Throughout this mentorship, I was able to get a start in DevOps and learn how to work on the compiler and source code for a software program while contributing to the user experience of everyone who uses Tremor and whoever will use Tremor in the future.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="starting-tremor">Starting Tremor<a href="#starting-tremor" class="hash-link" aria-label="Direct link to Starting Tremor" title="Direct link to Starting Tremor">​</a></h2><p>To learn how to contribute to Tremor’s source code, I had to first understand how Tremor worked and what it did. I was introduced to pipelines, ports, and scripts and was allowed to mess around with the code. Tremor’s code allowed the user to go into several commands to process and change the input into the desired output. Through playing around with Tremor, I decided to add a function to reverse a string with Tremor’s pipelines. Because tremor did not have a built-in reverse string function, I went into the source code to implement a reverse function in Rust along with several tests and documentation for the reverse function. This relatively simple function is where I made my first pull request and also where I first started getting familiar with Tremor.</p><p>Additionally, I had used other programming languages in my academic career, and therefore did not have any experience with Rust beforehand. This is when I got introduced to Rustlings, which had small exercises to help me with starting with Rust syntax and writing code in Rust. There were also a lot of functions unique to Rust in terms of how the code worked, which included enums, move semantics, and structs. This also included constructs like <code>Ok()</code> and concepts like async/await which I would end up utilizing in my project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-code">Understanding Code<a href="#understanding-code" class="hash-link" aria-label="Direct link to Understanding Code" title="Direct link to Understanding Code">​</a></h2><p>A large portion of my mentorship focused on understanding the errors that were printed out. There were several different kinds of errors, such as ones that dealt with the console input, console output, pipeline input, and more, which validated whether the input or output existed in the code and where it led to, another connector or the console. While this may seem simple, this ended up leading me into the rabbit hole of the source code as I traversed through numerous files and functions to determine where the error went through and what I could do to the preexisting code to read and perform functions onto the error.</p><p>To do a lot of this, I learned the process of error logging. I defined each error there in great detail, such as what it is, what it does currently, what it’s supposed to do, and gradually updated it every time it was needed. Throughout implementing messages to these errors, I also learned more about version control with git. While I did have practice on the basics like git pull and git push, I also learned about git rebase, git merge, and more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling">Error Handling<a href="#error-handling" class="hash-link" aria-label="Direct link to Error Handling" title="Direct link to Error Handling">​</a></h2><p>Error handling was the main focus of the project. As my mentor suggested, I focused on one error at a time from the error logs. First, I focused on the worst case- a case where nothing was printed and the program ran as if everything was normal, except there was no output. </p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="pipeline_out_errortroy">pipeline_out_error.troy<a href="#pipeline_out_errortroy" class="hash-link" aria-label="Direct link to pipeline_out_error.troy" title="Direct link to pipeline_out_error.troy">​</a></h6><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Our main flow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">define flow main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # import the `tremor::connectors` module</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  use tremor::connectors;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  use lib::pipelines;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # create an instance of the console connector</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  create connector console from connectors::console;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # create an instance of the passthrough pipeline</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  create pipeline main from pipelines::main;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # connect the console (STDIN) to our pipeline input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  connect /connector/console/out to /pipeline/main;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # then connect the pipeline output to the console (STDOUT)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # no doesn&#x27;t exist, bad error</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  connect /pipeline/main/no to /connector/console/in;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Deploy the flow so tremor starts it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">deploy flow main;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This error focused on the fact that the output did not exist, so to fix the error, I wrote a separate function that checked whether the output existed, then connected it to the <code>ConnectInput</code> structs while sending an error statement and a status report to the system. This process introduced me to focusing on small incremental steps rather than solving the problem as a whole and allowed me to not get overwhelmed. Additionally, <code>outputs</code> had to be added to the <code>Executable Graph</code> struct, which led me to implementing outputs in related functions and building a hashmap for the representation of its graph. With that, the basic problem of catching the errors was solved for that error problem.</p><p>After that led to defining what the error was, which involved adding a <code>port</code> struct to both <code>ConnectInput</code> and <code>ConnectOutput</code> to connect inputs. This port struct wasn’t needed before but with changes that were made later on, <code>port</code> proved to be very useful in defining what the port was to be able to be used in other code. Because this field was added to the struct, changes then had to be made to all the functions that used this struct and a port had to be defined in those functions.</p><p>Last was implementing where the code was to the user. This focused heavily on adding transmitters and receivers to output the status and mapping the status when the user’s code had errors. The transmitters and receivers, <code>tx</code> and <code>rx</code> had to be added to the <code>ConnectInput</code> and <code>ConnectOutput</code> structs, then weaved together with the other types of code to be defined and used. This involved many functions to be modified in order to return a result. In this process, there were also bugs to be fixed in the preexisting code and tests that had to be corrected in order to make sure <code>tx</code> and <code>rx</code> were properly working. Afterwards, <a href="https://doc.rust-lang.org/std/result/enum.Result.html#method.map_err" target="_blank" rel="noopener noreferrer"><code>Result::map_err</code></a> was used in order to map out the results with its parameters through <code>rx</code> if a user inputted errors.</p><p>Throughout the programming, I had to search for the files to determine where the code was and what function utilized the next function. This led me to search into files to see where the error travels through and trace where the error goes as I searched through the declarations, definitions, and references of variables and functions. I also got to learn several handy keyboard shortcuts throughout this process as demonstrated from my mentor.</p><h1>Conclusion</h1><p>Overall, working with Tremor was extremely fun and valuable as I not only got to contribute to an incredible project, but also got to learn more about programming and the open-source world.  I was able to while meeting amazing people to guide me with my work, and I can not imagine it to be any other way.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cncf">cncf</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mentorship">mentorship</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/07/07/LFX-Blog-Sasha">Support for the ClickHouse database in Tremor</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-07-07T00:00:00.000Z" itemprop="datePublished">July 7, 2022</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/scrabsha/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sasha Pourcelot</span></a></div><small class="avatar__subtitle" itemprop="description">Tremor 2022 Spring Mentee</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>I&#x27;m Sasha, a Computer Science student living in south-eastern France. I contributed to Tremor as part of the <a href="https://mentorship.lfx.linuxfoundation.org/project/5c828028-f91c-4969-b4de-9efdb27bb869" target="_blank" rel="noopener noreferrer">Database Connector mentorship</a> proposed by the <a href="https://lfx.linuxfoundation.org/tools/mentorship/" target="_blank" rel="noopener noreferrer">LFX Mentorship Program</a> for Spring 2022. I was mentored by Matthias Wahl and got help from Darach Ennis, Heinz Gies and Ramona Łuczkiewicz.</p><p>This blogpost summarizes my work at Tremor as a mentee and shows what could be done next.</p><h1>About Tremor</h1><p>Tremor is an event processing system with the goal of allowing users to handle a high volume of messages by viewing them as a stream flowing between different nodes of a graph. Events go in and out of this graph thanks to connectors.</p><p>The interactions between each node and the connector configuration are defined using the <a href="https://www.tremor.rs/docs/edge/language/" target="_blank" rel="noopener noreferrer"><code>troy</code></a> programming language.</p><h1>Abstract</h1><p>My mentorship at Tremor was focused on building a connector for the <a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer">ClickHouse</a> database engine. More specifically, I was focused on the <em>sink</em> part, the one that allows data to flow out of the Tremor application.</p><p><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer">ClickHouse</a> is a database management system designed to allow for real-time analysis of high volumes of non-aggregated data. Its initial goal was to power the Yandex.Metrica analytics platform.</p><h1>The ClickHouse connector</h1><p>The next subsections describe what I did during the mentorship.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="interacting-with-a-clickhouse-database-in-rust">Interacting with a ClickHouse database in Rust<a href="#interacting-with-a-clickhouse-database-in-rust" class="hash-link" aria-label="Direct link to Interacting with a ClickHouse database in Rust" title="Direct link to Interacting with a ClickHouse database in Rust">​</a></h2><p>My first goal was to find a way to send requests to a ClickHouse node from a Rust program. It was a good start because it allowed me to experiment on the ClickHouse side without caring about what was happening in Tremor. I spent around three weeks playing on a separate repository named <a href="https://github.com/scrabsha/plays-with-clickhouse" target="_blank" rel="noopener noreferrer"><code>scrabsha/plays-with-clickhouse</code></a> and getting extensive knowledge from Matthias about how Tremor works from the inside.</p><p>I found two Rust crates that could help us send requests to a ClickHouse database: <a href="https://crates.io/crates/clickhouse" target="_blank" rel="noopener noreferrer"><code>clickhouse</code></a> and <a href="https://crates.io/crates/clickhouse-rs" target="_blank" rel="noopener noreferrer"><code>clickhouse-rs</code></a>. <code>clickhouse</code> is the first one I considered. I had to discard it because it was focused on concrete Rust types and needed to know <em>at compile time</em> what each datatype is composed of. The second crate was a bit more low-level and allowed us to do what we need.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="writing-a-super-simple-sink">Writing a super simple sink<a href="#writing-a-super-simple-sink" class="hash-link" aria-label="Direct link to Writing a super simple sink" title="Direct link to Writing a super simple sink">​</a></h2><p>Once I got every ClickHouse detail right, I started playing with the Tremor side. There were multiple connectors already implemented in Tremor. I picked the simplest ones and started copying parts of it and quickly got something working.</p><p>The only challenge I encountered is that Tremor defines its own <code>Value</code> type, representing a value whose type is not really known at compile time, and uses it <em>a lot</em>. It was a bit disconcerting doing such things in Rust, as I felt I was writing dynamically-typed code in a statically-typed language, but I managed to get through it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="converting-tremor-values-to-clickhouse-values">Converting Tremor values to ClickHouse values<a href="#converting-tremor-values-to-clickhouse-values" class="hash-link" aria-label="Direct link to Converting Tremor values to ClickHouse values" title="Direct link to Converting Tremor values to ClickHouse values">​</a></h2><p>Once I was able to insert data in a database from Tremor, I started writing a conversion bridge for ClickHouse types, i.e. something that would handle the conversion of native Tremor values to their corresponding ClickHouse types. </p><p>Most of the conversions are quite simple: an integer can be obtained from an integer, a string can be obtained from any string, and so on.</p><p>Some other conversions were less obvious. For instance, in order to create a ClickHouse IPv4 type, we could either use a string representing the address, or an array of four integers. The goal was to make every ClickHouse type constructible from a Tremor value. I tried to make every conversion as obvious as possible, and to document them as much as possible.</p><p>The first implementation of this mapping function was huge. It was about 250 lines of tricky and slightly incorrect code. I managed to rewrite it from scratch using another approach and it got way better.</p><p>Working on this specific part led me to open three pull request to the <code>clickhouse-rs</code> crate:</p><ul><li><a href="https://github.com/suharev7/clickhouse-rs/pull/171" target="_blank" rel="noopener noreferrer">Make Value fully constructible (#171)</a></li><li><a href="https://github.com/suharev7/clickhouse-rs/pull/172" target="_blank" rel="noopener noreferrer">Compare IP adresses properly (#172)</a></li><li><a href="https://github.com/suharev7/clickhouse-rs/pull/173" target="_blank" rel="noopener noreferrer">Allow for Enum8 and DateTime64 value comparison (#173)</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2><p>The conversion function described in the previous subsection was fairly complex. Each possible conversion and cast has been carefully tested in order to ensure that it behaves correctly. These tests were greatly simplified thanks to the use of declarative macro.</p><p>Some other tests were focused on testing the sink as a whole, and how it would interact with a ClickHouse database. In this kind of test, we would run ClickHouse Docker containers, create a ClickHouse sink, plug the sink to the container, send some events, and see what has been inserted in the ClickHouse side.</p><h1>What to do next?</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improving-the-sink">Improving the sink<a href="#improving-the-sink" class="hash-link" aria-label="Direct link to Improving the sink" title="Direct link to Improving the sink">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatically-getting-the-table-schema">Automatically getting the table schema<a href="#automatically-getting-the-table-schema" class="hash-link" aria-label="Direct link to Automatically getting the table schema" title="Direct link to Automatically getting the table schema">​</a></h3><p>It turns out that ClickHouse has a <a href="https://clickhouse.com/docs/en/sql-reference/statements/describe-table" target="_blank" rel="noopener noreferrer"><code>DESCRIBE TABLE</code> statement</a>, which allows to gather information about each column of a specific table. We currently rely on the end-user to provide us valid information about the table columns. Using this statement would reduce the amount of information we require from them, hence making it simpler to use.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inserting-data-concurrently">Inserting data concurrently<a href="#inserting-data-concurrently" class="hash-link" aria-label="Direct link to Inserting data concurrently" title="Direct link to Inserting data concurrently">​</a></h3><p>The current implementation of the ClickHouse container uses a single database connection object, which is reused across insertions. A good way to improve this system is to use multiple concurrent connections, so that we could insert multiple batch of events at once.</p><p>A similar pattern has already been implemented in Tremor as part of the <a href="https://www.tremor.rs/docs/edge/reference/connectors/elastic" target="_blank" rel="noopener noreferrer"><code>elastic</code></a> connector. As such, most of the required machinery is already there.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-source-part">The source part<a href="#the-source-part" class="hash-link" aria-label="Direct link to The source part" title="Direct link to The source part">​</a></h2><p>This mentorship was focused on building a sink for ClickHouse. The next step could be to add a source connector, so that coming from a ClickHouse database can be ingested directly into a Tremor application.</p><p>ClickHouse has a feature allowing to watch for updates in a given table. This way, we can simulate a stream of data, and make it flow in the Tremor system. Each time some data is inserted in the table, we can retrieve it, convert it into Tremor value and make it flow into the graph of nodes described earlier.</p><p>This is something that we totally want to see in Tremor in the future. We can&#x27;t wait for the <a href="https://clickhouse.com/docs/en/sql-reference/statements/watch/" target="_blank" rel="noopener noreferrer"><code>WATCH</code> statement</a> to be considered stable.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/database">Database</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/click-house">ClickHouse</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/06/15/tdengine-colaboration">TDengine colaboration</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-06-15T00:00:00.000Z" itemprop="datePublished">June 15, 2022</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/60009416?s=200&amp;v=4" alt="Tremor Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Tremor Team</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>The best aspect of open source software is collaboration, not only of systems but of the people involved. It is wonderful to see them come together to take multiple parts to build something bigger out of them.</p><p>In this spirit, we had the chance to collaborate on a little project with the crew from <a href="https://tdengine.com/" target="_blank" rel="noopener noreferrer">TDengine</a>. For those that don’t know them yet, TDengine is an exciting new time-series database focusing on scalability, performance, and using SQL as a way to interact. Better yet using the <a href="https://docs.tdengine.com/reference/taosadapter" target="_blank" rel="noopener noreferrer">adapter</a> allows using a number of protocols including the Influx Line Protocol.</p><p>This does compliment tremor extremely well, as what we build can be described as an event processing engine focusing on performance and usability, using SQL as a way to manipulate data. I’m pretty sure you can already see how those two pieces fit together.</p><p>But, we don’t want to go much into the technical details here the post over at the <a href="https://tdengine.com/2022/06/14/6434.html" target="_blank" rel="noopener noreferrer">TDengine blog</a> does a wonderful job at that.</p><p>Working with Shuduo on this was a lot of fun, it was a fascinating forth and back of ideas and possible improvements. The integration was super painless with both systems supporting the same protocols, and it was really great to learn some tricks from the experts, like how queries work best in TDengine.</p><p>The most interesting part of this is however that both systems not only create the proverbial, larger sum than their parts are but also grow in the process.</p><p>And the speed the folks at TDengine do that is amazing, during the time of the collaboration, they not only released <a href="https://grafana.com/grafana/plugins/tdengine-datasource/" target="_blank" rel="noopener noreferrer">an official grafana data source</a>, released a <a href="https://github.com/taosdata/TDengine/releases/tag/ver-2.6.0.1" target="_blank" rel="noopener noreferrer">new version of TDengine itself</a>, but also created and published a <a href="https://grafana.com/grafana/dashboards/16388" target="_blank" rel="noopener noreferrer">grafana dashboard</a> for system monitoring that made it extremely easy to add this.</p><p>For tremor we have discovered that we’re really starting to miss sliding windows, they have been on the roadmap for a while, but never with any direct requirement other than “it would be nice to have them”. While talking about real-time alerting, sliding windows have significant advantages over tumbling windows, so this collaboration revived that discussion - which means we’ll hopefully add them sooner rather than later.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/collaboration">collaboration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/tdengine">tdengine</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/06/03/LFX-Blog-Prashant">Automating the tremor release process</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-06-03T00:00:00.000Z" itemprop="datePublished">June 3, 2022</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/prashantpm20/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Prashant</span></a></div><small class="avatar__subtitle" itemprop="description">Tremor 2022 Spring Mentee</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>It was a pleasant night. I was waiting for LFX to send acceptance/rejection e-mails. And there it was, <code>&quot;Congratulations! You were accepted to CNCF - Tremor&quot;</code> . It was a great and exciting feeling to start this journey! And here I am, at the end of it, writing this blog. It was wonderful, everything that I expected it to be, and even more so in the 3 months! I am writing this blog about my experience in this mentorship.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>My name&#x27;s Prashant (Also known as Pimmy on the internet), a 2nd-year university student pursuing my Bachelor&#x27;s degree in Information Technology. This blog will talk about my project experience in contributing to <a href="https://www.tremor.rs" target="_blank" rel="noopener noreferrer">Tremor</a> as part of LFX Mentorship Program Spring 2022.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem">The Problem<a href="#the-problem" class="hash-link" aria-label="Direct link to The Problem" title="Direct link to The Problem">​</a></h2><p>We all hate manual tasks, don&#x27;t we? No seriously if anyone loves doing things on their own, it&#x27;s totally fine. Of course not everything can be automated. But in this case, it was something more tedious. Here&#x27;s a flowchart for basic explanation: </p><p><img loading="lazy" src="https://user-images.githubusercontent.com/23097199/171433037-99f4d443-7b84-4dc0-b026-972831108889.png" alt="Flow" class="img_ev3q"></p><p>This is how it was done, but manually. Each process had to be checked by someone to ensure a smooth sailing. It was quite the work, and so making a release candidate was never easy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-approach">The Approach<a href="#the-approach" class="hash-link" aria-label="Direct link to The Approach" title="Direct link to The Approach">​</a></h2><p>The first thing was to divide the tasks into smaller sections and work on this. As my mentors at tremor always used to say, make notes! Keep documenting stuff, really helps. These notes helped me divide the tasks of the current CI process into individual sets of goal, and then I started working on it. </p><p>Now I did have to test <em>a lot</em>, 400+ workflows just to get this finally done. So I will explain how the release process works. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="drafting-the-release">Drafting the release<a href="#drafting-the-release" class="hash-link" aria-label="Direct link to Drafting the release" title="Direct link to Drafting the release">​</a></h3><ol><li>We select which version we want to release, as shown in the code snippet taken from github actions workflow yaml file.</li></ol><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">workflow_dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">new-version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> choice</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Which version you&#x27;d like to release?&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">options</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> major (_.X.X)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> minor (X._.X)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> patch (X.X._)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> rc (X.X.X</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">rc)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> release (removes rc)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Extract the version input (we want major, minor, patch, etc without the brackets), and bumping cargo packages, as shown below. As you can see I extracted the old version before the bump, and put it into <code>$GITHUB_ENV</code> , which is creating env variables with these values. Similarly done for new version after the bump. They are needed for creating the PR. </li></ol><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Extracting version from input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          VERSION=$(echo &quot;${{github.event.inputs.new-version}}&quot; | sed &#x27;s/ (.*)$//&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          echo &quot;VER=$VERSION&quot; &gt;&gt; $GITHUB_ENV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Bump new version in TOML files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          OLD_VERSION=$(cargo pkgid | cut -d# -f2 | cut -d: -f2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          echo &quot;OLD=$OLD_VERSION&quot; &gt;&gt; $GITHUB_ENV</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          cargo set-version --workspace --bump ${{ env.VER }}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          NEW_VERSION=$(cargo pkgid | cut -d# -f2 | cut -d: -f2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">          echo &quot;NEW=$NEW_VERSION&quot; &gt;&gt; $GITHUB_ENV   </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Commit, push, and Pull Request is created automatically with <code>Release</code> tag for the release. From there, the maintainers will do all the necessary reviews, and merge once the CI passes.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="publishing-release">Publishing Release<a href="#publishing-release" class="hash-link" aria-label="Direct link to Publishing Release" title="Direct link to Publishing Release">​</a></h3><ul><li>So, the Draft Release pull request is merged, great! It automatically triggers the release workflow, which by the way only works if the PR has the <code>Release</code> tag, and ignores all other. This is achieved using the conditional statement:</li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token key atrule">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> github.event.pull_request.merged </span><span class="token important">&amp;&amp;</span><span class="token plain"> contains( github.event.pull_request.labels.</span><span class="token important">*.name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> &#x27;Release&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Changelog is automatically extracted using this <a href="https://github.com/ffurrer2/extract-release-notes" target="_blank" rel="noopener noreferrer">great workflow action</a>, and the release is made.</li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Extract release notes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> extract</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">release</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">notes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ffurrer2/extract</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">release</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">notes@v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Create release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> actions/create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">release@v1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>To trigger the publish crates workflow, I used this <a href="https://github.com/benc-uk/workflow-dispatch" target="_blank" rel="noopener noreferrer">workflow dispatch action</a> as shown below:</li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Trigger publish crates workflow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> benc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">uk/workflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dispatch@v1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">workflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Publish crates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> secrets.PAT_TOKEN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And that&#x27;s it for the release!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="publishing-crates">Publishing crates<a href="#publishing-crates" class="hash-link" aria-label="Direct link to Publishing crates" title="Direct link to Publishing crates">​</a></h3><p>The Publish crates workflow is now triggered as mentioned in the previous state. There are 4 main crates to be published, and one job to trigger the draft release workflow for tremor-language-server repo (All automated!). Github actions makes it really great to see which job is interconnected.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/23097199/171507584-c8a1bb81-0cbc-4a70-966e-b998758e6430.png" alt="image" class="img_ev3q"></p><p>With all the crates published, including the language-server which follows the exact same process. Tremor has successfully released a new version! Congratulations!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-thoughts">My thoughts<a href="#my-thoughts" class="hash-link" aria-label="Direct link to My thoughts" title="Direct link to My thoughts">​</a></h2><p>The tremor community has been extremely helpful in guiding me through the entire mentorship. They have this principle of &quot;Never <em>worry</em>, have fun&quot; that will always stay forever with me, and forward in my career. Special mention for <a href="https://github.com/Licenser" target="_blank" rel="noopener noreferrer">Heinz</a> who mentored me throughout the months and helped me. And to the tremor community in general, my thanks to all of them!
I didn&#x27;t know much about github actions or DevOps in general. But now I can confidently say that I can indeed, <em>make processes boring by automating them</em>. I will continue to engage in open source projects, and guide others to the same, cheers!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/dev-ops">DevOps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ci">CI</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mentorship">mentorship</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cncf">cncf</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/06/02/tremor-tremors">Tremors - May &#x27;22</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-06-02T00:00:00.000Z" itemprop="datePublished">June 2, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/GaryPWhite" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/7660110?v=4" alt="Gary + The Tremor Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/GaryPWhite" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Gary + The Tremor Team</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Welcome, Tremor Enthusiasts! This post is another in a series intended to inform and entertain Tremor Technologists with recent changes in the <code>tremor</code> project. We&#x27;ll mostly focus these posts on Pull Requests and other notable developments. With these posts, you can stay informed and learn more about the project without having to read pull requests, or wait for release notes.</p><p>Have you ever cleaned the house for company, to make it seem like nobody lives there? That’s basically what we’ve been up to getting ready for 0.12.0. It’s a big deal. We&#x27;re trying to make the codebase spotless with plenty of sweeping up. We also thank our contributors for all the hard work put into automation and new stuff this month!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-stuff">New Stuff<a href="#new-stuff" class="hash-link" aria-label="Direct link to New Stuff" title="Direct link to New Stuff">​</a></h2><p>Most exciting of all: <a href="https://github.com/tremor-rs/tremor-runtime/releases/tag/v0.12.0" target="_blank" rel="noopener noreferrer">We made the 0.12.0 release</a>! We put a lot of cool stuff in right before releasing, so finish the article before you jump in!</p><p>Being able to make a new tremor project has been a pain point from some of our users. We wanted <a href="https://www.tremor.rs/docs/0.12/getting-started/" target="_blank" rel="noopener noreferrer">getting started</a> to be as easy as typing a command. Now it is! You can simply call our <a href="https://github.com/tremor-rs/tremor-runtime/pull/1671" target="_blank" rel="noopener noreferrer">fancy new command</a> to make a <code>new</code> tremor template. Quick and easy!</p><p>Our elasticsearch integrations got some upgrades with support for <a href="https://github.com/tremor-rs/tremor-runtime/pull/1653" target="_blank" rel="noopener noreferrer">raw elastic payloads</a> through our connector, and <a href="https://github.com/tremor-rs/tremor-runtime/pull/1663" target="_blank" rel="noopener noreferrer">native support for auth</a> between elastic &lt;-&gt; tremor. No more need for custom headers on connectors! Check out the links provided for more details, and we&#x27;ll update the docs soon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ci">CI<a href="#ci" class="hash-link" aria-label="Direct link to CI" title="Direct link to CI">​</a></h2><p>The CI has been changed heavily in the last month. We have <a href="https://github.com/PrimalPimmy" target="_blank" rel="noopener noreferrer">PrimalPimmy</a> on GitHub to thank for much of the contributions. Thank you!</p><p>We&#x27;ve tweaked our CI when we <a href="https://github.com/tremor-rs/tremor-runtime/pull/1679" target="_blank" rel="noopener noreferrer">create a release</a> that should prevent creating crates unexpectedly. We also trigger <a href="https://github.com/tremor-rs/tremor-runtime/pull/1673" target="_blank" rel="noopener noreferrer">many workflows across our projects</a> from a release flow in tremor-runtime. We also decided that publishing in <a href="https://github.com/tremor-rs/tremor-runtime/pull/1649" target="_blank" rel="noopener noreferrer">many steps</a> would help to prevent <a href="https://github.com/tremor-rs/tremor-runtime/pull/1644" target="_blank" rel="noopener noreferrer">single points</a> of failure.</p><p>We can also better provide <a href="https://github.com/tremor-rs/tremor-runtime/pull/1624" target="_blank" rel="noopener noreferrer">descriptive options</a> when we create a release. We can also provide <a href="https://github.com/tremor-rs/tremor-runtime/pull/1609" target="_blank" rel="noopener noreferrer">better options for publishing</a>.</p><p>Lastly, we tweaked <a href="https://github.com/tremor-rs/tremor-runtime/pull/1682/files" target="_blank" rel="noopener noreferrer">how much we use sed</a> when we cut a release. This one is great for a quick example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> tremor-script</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;s/^tremor-common = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${old}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/tremor-common = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${new}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/&quot;</span><span class="token plain"> -i.release </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cargo.toml&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;s/^tremor-influx = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${old}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/tremor-common = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${new}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/&quot;</span><span class="token plain"> -i.release </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cargo.toml&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;s/^tremor-value = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${old}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/tremor-common = { version = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${new}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">/&quot;</span><span class="token plain"> -i.release </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cargo.toml&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where we used to manually edit each project&#x27;s <code>.toml</code> file, we now do this as part of our <a href="https://github.com/tremor-rs/tremor-runtime/actions" target="_blank" rel="noopener noreferrer">GitHub Actions workflow</a> elsewhere.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sweeping-up">Sweeping Up<a href="#sweeping-up" class="hash-link" aria-label="Direct link to Sweeping Up" title="Direct link to Sweeping Up">​</a></h2><p>As we mentioned before, there was a lot of sweeping up we wanted to finish before the newest release.</p><p>One of the more interesting fixes we put in was a small bug for <code>tremor run</code>. Something that had gone unnoticed for a while was an <a href="https://github.com/tremor-rs/tremor-runtime/pull/1582" target="_blank" rel="noopener noreferrer">upper limit</a> when running tremor scripts. After 150 seconds, the script would time out. A strange and small feature limitation we didn&#x27;t notice.</p><p>We had a lot of work specifically to do on connectors.</p><ul><li>Some connectors wrote <a href="https://github.com/tremor-rs/tremor-runtime/pull/1662" target="_blank" rel="noopener noreferrer">more events</a> than they should</li><li>Edge cases existed where we would acknowledge error events <a href="https://github.com/tremor-rs/tremor-runtime/pull/1670" target="_blank" rel="noopener noreferrer">without processing them</a>.</li><li>Some <a href="https://github.com/tremor-rs/tremor-runtime/pull/1651" target="_blank" rel="noopener noreferrer">bench connectors</a> would not stop as expected.</li><li>Show errors on <a href="https://github.com/tremor-rs/tremor-runtime/pull/1606" target="_blank" rel="noopener noreferrer">unknown connector</a> types, instead of silently failing.</li><li>Make destructive connector actions <a href="https://github.com/tremor-rs/tremor-runtime/pull/1668" target="_blank" rel="noopener noreferrer">much more difficult</a> to accidentally stumble upon.</li></ul><p>We also removed a limitation we had for code coverage. Where our contributors would have to avoid <a href="https://github.com/tremor-rs/tremor-runtime/pull/1666" target="_blank" rel="noopener noreferrer">functionally any drop at all</a> in code coverage, we now allow a <code>.1</code> percent drop.</p><p>If you were a using the <code>tremor api</code> sub command, you should be aware that we&#x27;ve <a href="https://github.com/tremor-rs/tremor-runtime/pull/1650" target="_blank" rel="noopener noreferrer">completely deprecated</a> the subcommand.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug Fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to Bug Fixes" title="Direct link to Bug Fixes">​</a></h2><p>Our bug fixes were pretty few over ht elast month. We had some <a href="https://github.com/tremor-rs/tremor-runtime/pull/1655" target="_blank" rel="noopener noreferrer">publishing</a>, <a href="https://github.com/tremor-rs/tremor-runtime/pull/1702" target="_blank" rel="noopener noreferrer">connecting</a>, and <a href="https://github.com/tremor-rs/tremor-runtime/pull/1677" target="_blank" rel="noopener noreferrer">regular expressions</a> patches. We updated our new <a href="https://github.com/tremor-rs/tremor-runtime/pull/1676" target="_blank" rel="noopener noreferrer">code coverage tool</a>, codecov, to more accurately track our coverage. We also found that piping information to tremor would <a href="https://github.com/tremor-rs/tremor-runtime/pull/1701" target="_blank" rel="noopener noreferrer">sometimes cause issues</a> and fixed that.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thank-you">Thank You<a href="#thank-you" class="hash-link" aria-label="Direct link to Thank You" title="Direct link to Thank You">​</a></h2><p>The Tremor project as strong as the community around it. Reading this article, making contributions, and generally being involved in the project makes us more successful. Thank you for reading and contributing! See you next time.</p><ul><li>Gary, and the Tremor team.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/collaboration">collaboration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wayfair">wayfair</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/tremors">tremors</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2022/05/03/tremor-tremors">Tremors - April &#x27;22</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-05-03T00:00:00.000Z" itemprop="datePublished">May 3, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/GaryPWhite" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/7660110?v=4" alt="Gary + The Tremor Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/GaryPWhite" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Gary + The Tremor Team</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Welcome, Tremor Enthusiasts! This is the first post in a series intended inform and entertain Tremor Technologists with recent changes in the <code>tremor</code> project. We&#x27;ll mostly focus these posts on Pull Requests and other notable developments. With these posts, you can stay informed and learn more about the project without having to read pull requests, or wait for release notes.</p><p>This posts&#x27; theme is <em>open and improved communication</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-candidates">Release Candidates<a href="#release-candidates" class="hash-link" aria-label="Direct link to Release Candidates" title="Direct link to Release Candidates">​</a></h2><p>Where&#x27;s the next release of Tremor?!</p><p>Tremor&#x27;s release schedule is becoming a bit more regular. We&#x27;re releasing <a href="https://github.com/tremor-rs/tremor-runtime/releases" target="_blank" rel="noopener noreferrer">about twice a year</a>, every 6 to eight months. The next release of Tremor should include an exciting new way to write plugins with the <a href="https://github.com/tremor-rs/tremor-runtime/issues/791" target="_blank" rel="noopener noreferrer">plugin development kit</a>, along with other goodies for faster, <a href="https://github.com/tremor-rs/tremor-runtime/pull/1571/files" target="_blank" rel="noopener noreferrer">well understood tremor scripts</a> and plenty of other <a href="https://github.com/tremor-rs/tremor-runtime/pull/1539" target="_blank" rel="noopener noreferrer">performance</a> and <a href="https://github.com/tremor-rs/tremor-runtime/pull/1537" target="_blank" rel="noopener noreferrer">bug fixes</a>.</p><p>Most notable as an update for us all is that Tremor has a <a href="https://github.com/tremor-rs/tremor-runtime/releases/tag/v0.12.0-rc.1" target="_blank" rel="noopener noreferrer">release candidate</a> live. If we&#x27;re pleased with it, then a new version of tremor is soon to be released!</p><p>In this article, Let&#x27;s dive into three topics: <a href="#ci">CI</a>, <a href="#pdk-plugin-development-kit">PDK</a>, and <a href="#performance">performance</a>!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ci">CI<a href="#ci" class="hash-link" aria-label="Direct link to CI" title="Direct link to CI">​</a></h2><p>One of my favorite parts of working with tremor, or any project, is using automation. Running a bunch of stuff on my machine can be quicker, but less reliable than a well established automation platform. Tremor makes an effort to improve Continuous integration regularly; and this month is no exception.</p><p>One of our active members of the Tremor Community, <a href="https://github.com/PrimalPimmy" target="_blank" rel="noopener noreferrer">Pimmy</a> has taken it upon himself to dramatically improve the CI and relase process for <code>tremor-runtime</code>.</p><p>The <a href="https://github.com/tremor-rs/tremor-runtime/pull/1545/files" target="_blank" rel="noopener noreferrer">new process</a> will automatically publish a release when we&#x27;re ready. Using this automatino, we can bump versions appropriately with specially named branches and some fancy <a href="https://github.com/tremor-rs/tremor-runtime/runs/6026528631?check_suite_focus=true" target="_blank" rel="noopener noreferrer">GitHub Actions</a>. This lets the Tremor team take full advantage of the seamless GitHub experience from merge -&gt; release, complete with logs and links directly from the Pull Request. We can even extract release notes and <a href="https://github.com/tremor-rs/tremor-runtime/pull/1563/files" target="_blank" rel="noopener noreferrer">bump versions automatically</a>. Once again, truly great work from our community here!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pdk-plugin-development-kit">PDK (Plugin Development Kit)<a href="#pdk-plugin-development-kit" class="hash-link" aria-label="Direct link to PDK (Plugin Development Kit)" title="Direct link to PDK (Plugin Development Kit)">​</a></h2><p>I won&#x27;t spend too much time on this point, since the lovely <a href="https://github.com/marioortizmanero" target="_blank" rel="noopener noreferrer">marioortizmanero</a> has already taken the time to write out <a href="https://nullderef.com/blog/plugin-abi-stable/" target="_blank" rel="noopener noreferrer">a full blog post</a> or <a href="https://nullderef.com/blog/plugin-impl/" target="_blank" rel="noopener noreferrer">two</a> on the topic. We&#x27;ll give a full breakdown another time. For now: know that Tremor is currently in the works of creating an easier way for developers to plug their own binaries into the system to run connectors and pipelines.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a href="#performance" class="hash-link" aria-label="Direct link to Performance" title="Direct link to Performance">​</a></h2><p>Tremor cares <a href="https://www.tremor.rs/community/development/benchmarks/LogstashBenchmark" target="_blank" rel="noopener noreferrer">a lot about performance</a>. As you may already know from <a href="https://www.youtube.com/watch?v=xsowS5hEKRg&amp;list=PLNTN4J6tdf20vy14FVOazLTdou_8xyvfe&amp;index=4" target="_blank" rel="noopener noreferrer">TremorCon 2021&#x27;s fabulous talks</a>; it was originally created and adopted for performance gains in Wayfair&#x27;s event processing infrastructure. There are plenty of performance gains to make in a project as large as Tremor, both inside the project and through dependencies.</p><p>One such dependency we depend on <a href="https://simdjson.org/" target="_blank" rel="noopener noreferrer">to parse gigabytes of JSON per second</a> is <a href="https://docs.rs/simd-json/0.3.18/simd_json/index.html" target="_blank" rel="noopener noreferrer">simd_json</a>. <code>simd_json</code> is a port of the simdjson c++ library into rust. It can not only parse from JSON into Rust, but aid the <code>serde</code> library that can easily serialize and deserialize Rust data structures. That&#x27;s pretty handy for an event processing project that will have to marshal plenty of events from disparate sources of all data forms! As you might imagine, a project like <code>simd_json</code> comes with a lot of configuration options, and optimizations behind those options.</p><p>Further than just the configuration that you might give <code>serde</code>, or <code>simd_json</code>, is the options you may give to the <a href="https://github.com/simd-lite/simd-json/blob/main/.cargo/config" target="_blank" rel="noopener noreferrer">rust compiler</a>. The compiler, by default, <a href="https://docs.rs/simd-json/latest/simd_json/index.html" target="_blank" rel="noopener noreferrer">compiles for the largest compatability.</a> For best performance on a specific plaform, we make use of the <code>target-feature</code> flag. This will allow us to target specific features available on different platforms and CPUs.</p><p>It should be no surprise that we continue this effort within the Tremor team. Know that we also depend on our community, such as a <a href="https://github.com/tremor-rs/tremor-runtime/pull/1522" target="_blank" rel="noopener noreferrer">pull request from scarabsha</a>. Sasha idenfitifed additional target-features for the target <code>x86_64-unknown-linux-gnu</code> that speed up the performance of <code>simd-json</code>. There&#x27;s not a benchmark to show exactly how much faster this made json processing, but we appreciate the fact that it will undoubtedly increase performance for some clients of Tremor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thank-you">Thank You<a href="#thank-you" class="hash-link" aria-label="Direct link to Thank You" title="Direct link to Thank You">​</a></h2><p>The Tremor project as strong as the community around it. Reading this article, making contributions, and generally being involved in the project makes us more successful. Thank you for reading and contributing! See you next time.</p><ul><li>Gary, and the Tremor team.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/collaboration">collaboration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wayfair">wayfair</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/tremors">tremors</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://www.tremor.rs/assets/images/redpanda-rocket-0282422a2035a2f4d294d7ce8fe8f473.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/12/13/redpanda">Collaboration - Using Redpanda with Tremor</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-12-13T00:00:00.000Z" itemprop="datePublished">December 13, 2021</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/60009416?s=200&amp;v=4" alt="Tremor Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Tremor Team</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Like all good projects in the open source community, great collaborations start with ad hoc interactions.</p><p><img loading="lazy" alt="Redpanda Rocket" src="/assets/images/redpanda-rocket-0282422a2035a2f4d294d7ce8fe8f473.png" width="2000" height="1403" class="img_ev3q"></p><p>A recent set of discussions between the Tremor maintainers and our community brought <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a> to our attention.</p><p>Some of our community would like to replace their Kafka deployments with <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a>, a Kafka API-compatible streaming
data platform, to realize gains in performance and reduce their total cost of operations. . As we already have Kafka
connectivity, enabling this shouldn’t be too complex, right? Let’s find out.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context">Context<a href="#context" class="hash-link" aria-label="Direct link to Context" title="Direct link to Context">​</a></h2><p>We are always looking out for interesting technology, and recently we read a <a href="https://vectorized.io/blog/wasm-architecture/" target="_blank" rel="noopener noreferrer">very interesting article</a> on the Redpanda
blog about using WASM as server-side filters for subscription. Being as excitable as we are, we obviously had to give
Redpanda a shot.</p><p>To our joy this turned out to be painless, Redpanda reuses the Kafka API so our existing connectors for Kafka work
out of the box — and as a bonus we could get rid of a whole bunch of docker-compose YAML dancing that we needed to
set up Zookeeper.</p><p>Alex Gallego, founder of Redpanda, reached out to us and we started experimenting with Tremor and Redpanda in this
repo: <a href="https://github.com/tremor-rs/tremor-redpanda" target="_blank" rel="noopener noreferrer">github.com/tremor-rs/tremor-redpanda</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-tremor-and-redpanda">Setting up Tremor and Redpanda<a href="#setting-up-tremor-and-redpanda" class="hash-link" aria-label="Direct link to Setting up Tremor and Redpanda" title="Direct link to Setting up Tremor and Redpanda">​</a></h2><p>So, let’s get our hands dirty and actually connect Redpanda and tremor in a real-world project.</p><p>We have prepared a fully equipped workshop for this occasion. Give it a shot <a href="https://www.tremor.rs/docs/0.11/recipes/redpanda_elastic_correlation/README" target="_blank" rel="noopener noreferrer">here</a>
if you are impatient.</p><p>Tremor can flexibly act as a Redpanda/Kafka consumer or producer, make use of auto-commit for offset management or manually commit
when events are completely handled by the tremor pipeline. Here we are configuring Tremor only committing offsets when events have been successfully handled.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">onramp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> redpanda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kafka</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">codec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">brokers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> redpanda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">topics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> tremor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">group_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> redpanda_es_correlation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">retry_failed_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">rdkafka_options</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This tremor application is reporting success or failure of ingesting the received events into elasticsearch via another Redpanda topic.
Configuring this is also straightforward, here we have a <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a> consumer ready for copy-pasting:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">offramp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> redpanda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">out</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kafka</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">codec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">group_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tremor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">brokers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> redpanda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> tremor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here you go. A fully working setup for orchestrating document ingestion with <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a> delivering the documents and receiving acknowledgements.
For more details check out this Redpanda <a href="/docs/0.11/recipes/redpanda_elastic_correlation">recipe</a> on our website.</p><p>Tremor is designed to be robust when faced with high volumetric data streams. It comes with batteries included for traffic shaping,
QoS and data distribution. With those tremor can guarantee at-least-once message delivery. We try to reduce CPU and memory footprint
for a given workload and at the same time provide a “just works” experience for operators. And we think we found a soulmate project in <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a>.</p><p>And most importantly, it is working like a charm. In fact we just dropped in <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a> and expected some hours of troubleshooting, but this hope
was cut short by a smooth transition:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.828694200+00:00 INFO tremor_runtime::system - Binding onramp tremor://localhost/onramp/redpanda-in/01/out</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.830056300+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Starting kafka onramp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.831848100+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Subscribing to: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tremor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.832735600+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Subscription initiated</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.833342+00:00 INFO tremor_runtime::onramp - Onramp tremor://localhost/onramp/redpanda-in/01/out started.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.828694200+00:00 INFO tremor_runtime::system - Binding onramp tremor://localhost/onramp/redpanda-in/01/out</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.830056300+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Starting kafka onramp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.831848100+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Subscribing to: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tremor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.832735600+00:00 INFO tremor_runtime::source::kafka - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Source::tremor://localhost/onramp/redpanda-in/01/out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Subscription initiated</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">104_redpanda_elastic_correlation-tremor_out-1     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2021</span><span class="token plain">-12-10T15:17:01.833342+00:00 INFO tremor_runtime::onramp - Onramp tremor://localhost/onramp/redpanda-in/01/out started.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Both in terms of operator friendliness and performance we root for <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a>.</p><p>We started using it in our integration test suite, so users can be 100% sure <a href="https://redpanda.com/" target="_blank" rel="noopener noreferrer">Redpanda</a> connectivity just works.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/collaboration">collaboration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wayfair">wayfair</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/12/04/LFX-Blog-Daksh">Connectors for Streaming to AWS S3</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-12-04T00:00:00.000Z" itemprop="datePublished">December 4, 2021</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/dak-x" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Daksh</span></a></div><small class="avatar__subtitle" itemprop="description">Tremor 2021 Fall Mentee</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>Hi folks, I&#x27;m Daksh, a senior year CS student at Indian Institute of Technology, Jammu. This blog talks about my project and experience contributing to <a href="https://www.tremor.rs" target="_blank" rel="noopener noreferrer">Tremor</a> as part of LFX Mentorship Program Fall 2021.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="learning-about-tremor">Learning about Tremor<a href="#learning-about-tremor" class="hash-link" aria-label="Direct link to Learning about Tremor" title="Direct link to Learning about Tremor">​</a></h3><p>I came across <a href="https://www.rust-lang.org/" target="_blank" rel="noopener noreferrer">rust</a> in early 2020, and I absolutely loved its design,  the syntax and how approachable it was to a beginner. I discovered Tremor while looking for open source projects written in rust. Tremor is an event processing system (think kafka) for unstructured data with rich support for structural pattern-matching, filtering and transformation. Over the summers, I did a few minor PR&#x27;s. Going through the examples and the <a href="https://www.tremor.rs/docs/index/" target="_blank" rel="noopener noreferrer">docs</a> I could set up Tremor and start hacking on!!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="my-project">My Project<a href="#my-project" class="hash-link" aria-label="Direct link to My Project" title="Direct link to My Project">​</a></h3><p>It is very common in event processing to stream data to a persistent storage engine for later processing or archival purposes. My job was to add connectors to stream data to AWS S3. You may find more information in the github <a href="https://github.com/tremor-rs/tremor-runtime/issues/1176" target="_blank" rel="noopener noreferrer">issue</a>.</p><p>So what is a connector?
A connector is the component of an Event Processing System that provides the functionality of communicating with the outside world. This would enable current, and future users of Tremor to now connect and stream events to any endpoint which supports the S3 API.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="aws-s3-connectors">AWS S3 Connectors<a href="#aws-s3-connectors" class="hash-link" aria-label="Direct link to AWS S3 Connectors" title="Direct link to AWS S3 Connectors">​</a></h4><p>I would explain the sink via an example. To connect to S3, one would require the s3 credentials. Due to lack of support from the sdk only public-secret key credentials are supported <em>(to be extended once the sdk supports other means for credentials)</em>.
Tremor would read the key names specified in the config from the environment.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="s3demotroy">s3demo.troy<a href="#s3demotroy" class="hash-link" aria-label="Direct link to s3demo.troy" title="Direct link to s3demo.troy">​</a></h6><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">define flow s3demo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    define connector s3conn from s3 with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    codec=&quot;json&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    config={</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;aws_access_token&quot;: &quot;AWS_ACCESS_KEY_ID&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;aws_secret_access_key&quot;: &quot;AWS_SECRET_ACCESS_KEY&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;aws_region&quot;: &quot;AWS_REGION&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;bucket&quot;: &quot;tremordemo&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;min_part_size&quot;: 5242880,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    define connector files3 from file with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    code=&quot;json&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    config={</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;mode&quot;: &quot;read&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;path&quot;: &quot;sample.json&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    preprocessors=[&quot;lines&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    define pipeline s3pipe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pipeline</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        define script s3Event</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            script</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            let e = event;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            let $s3 = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;key&quot;: e.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            let payload = e.payload;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        create script s3Event;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        select event from in into s3Event;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        select event from s3Event into out;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    create connector s3conn;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    create connector files3;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    create pipeline s3pipe;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    connect /connector/files3 to /pipeline/s3pipe;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    connect /pipeline/s3pipe to /connector/s3conn;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">deploy flow s3demo;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="samplejson">sample.json<a href="#samplejson" class="hash-link" aria-label="Direct link to sample.json" title="Direct link to sample.json">​</a></h6><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;key&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;key1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;payload&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;event1&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;key2&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;key&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;key2&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;payload&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;event3&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;nested Obj&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;vec1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;vec2&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;vec3&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;key&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;key3&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">&quot;payload&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;event3&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token null keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This configuration reads the file <code>sample.json</code> <em>delimited by lines</em> for events. The <code>s3pipe</code> pipeline destructures the line contents to set the <code>data</code> for the object to upload and its <code>key</code> as meta-data. The s3-sink would then upload the data to AWS S3 with key set to $key inside the bucket <code>tremordemo</code> <em>or anything that is given in the config</em></p><p><img loading="lazy" alt="Sample Working" src="/assets/images/s3diagram-295f6786ca081822d2571d86683d629d.png" width="626" height="217" class="img_ev3q"></p><p>The sink also has the <code>min_part_size</code> configuration parameter. S3 support uploading larger objects in multiple parts. One can send multiple events with the same <strong>key</strong> consecutively, and Tremor would append the content of all those events, and whenever the content size gets larger than the <strong>min_part_size</strong>, a part is uploaded to s3. Whenever the key changes or Tremor stops, the upload for the previous key is completed.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ending-thoughts">Ending Thoughts<a href="#ending-thoughts" class="hash-link" aria-label="Direct link to Ending Thoughts" title="Direct link to Ending Thoughts">​</a></h4><p>I had a very productive and fun time with the Tremor Community. The Tremor principle of &quot;never <strong>worry</strong> about it&quot; has helped me to deal with clueless moments during this mentorship. I would like to express my regards and gratitude to Matthias, Heinz, and Darach for giving me this wonderful opportunity and helping me develop as an open-source contributor and as a joyful person. A special thanks to Matthias for being there to clarify my doubts and fix my mistakes and for being really helpful.
I would continue to be a part of the Tremor Community and hope to engage with more newcomers to open-source. I would wish to be part of future CNCF events. You may see me around at the Tremor <a href="https://chat.tremor.rs" target="_blank" rel="noopener noreferrer">Discord</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/connectors">connectors</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/s-3">s3</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/mentorship">mentorship</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cncf">cncf</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://www.tremor.rs/assets/images/wayfair-b0bafac5cf230fcd5e29c8cb4560c334.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/11/09/php-dead-code-detection">Case Study - Dead Code Detection in PHP</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-11-09T00:00:00.000Z" itemprop="datePublished">November 9, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Agares" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/303398?v=4" alt="Ramona Łuczkiewicz"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Agares" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ramona Łuczkiewicz</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="identified-need">Identified Need<a href="#identified-need" class="hash-link" aria-label="Direct link to Identified Need" title="Direct link to Identified Need">​</a></h2><p>We have a humongous PHP application - around 20 million lines of code. It’s believed that there are certain parts of the codebase that are no longer used, but it’s hard to reliably find out which ones. Due to the dynamic nature of PHP, attempts at static analysis have failed. We decided that dynamic analysis was needed, and created a PHP extension that logs all the calls to all functions and methods. That’s a lot of data, and we used tremor to aggregate it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="required-outcome">Required Outcome<a href="#required-outcome" class="hash-link" aria-label="Direct link to Required Outcome" title="Direct link to Required Outcome">​</a></h2><p>We need to be able to aggregate a lot of data (the extension sends one message for each HTTP request, which can be at the order of hundreds per second for some servers), counting the number of calls to each function or method in the codebase and send it to our service which does further aggregation and presents the data.
<img loading="lazy" alt="High Level Architecture" src="/assets/images/dead_code_detection_diagram-ed8ac4fbb8b9c7d345902e0c616d0bfc.png" width="4810" height="910" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="characteristics">Characteristics<a href="#characteristics" class="hash-link" aria-label="Direct link to Characteristics" title="Direct link to Characteristics">​</a></h2><p>We used Unix Sockets (which were added as a source to tremor during this project) and then a simple script that aggregates the data. We’re hoping to use custom aggregate functions in the future (there’s an open RFC, waiting for the official voting) to further simplify the pipeline.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>We are currently testing the solution with smaller applications, seeing minimal performance impact and no impact on stability. We were able to delete unused code from those applications without affecting their operation.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/case-study">case-study</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wayfair">wayfair</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://www.tremor.rs/assets/images/wayfair-b0bafac5cf230fcd5e29c8cb4560c334.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/11/08/uop">Case Study - Unified Observability Platform</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-11-08T00:00:00.000Z" itemprop="datePublished">November 8, 2021</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/60009416?s=200&amp;v=4" alt="The Tremor Team"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tremor-rs" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">The Tremor Team</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>As Wayfair&#x27;s technology organization modernizes its infrastructure services to meet
new volumetric peaks they continually adapt, adopt and atrophy out systems and services.</p><p>This is particularly difficult with shared infrastructure and services that are ever-present
but seldom seen by many of the engineers in the organization.</p><p>The rise of OpenTelemetry provides an opportunity for developers to consolidate on SDKs that
are consistent across programming languages and frameworks. For our SRE&#x27;s and operators it
offers ease of integration and ease of migration of services.</p><p>Tremor is a core enabling component of Wayfair&#x27;s migration strategy. Tremor supports
but is endpoint, protocol and service agnostic. This allows our operational teams to
switch from on-premise to cloud native services with minimal coordination with others.</p><p>This also allows switching from in-house to managed or out of the box services supported
by cloud providers.</p><p>Moving 1000s of developers to a new technology stack when you are operating continuously
with no downtime and at a large scale is hard.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="identified-need">Identified Need<a href="#identified-need" class="hash-link" aria-label="Direct link to Identified Need" title="Direct link to Identified Need">​</a></h2><p>Tremor emerged from production needs in existing systems, specifically
in the logging and metrics or observability domains in a large
hypergrowth and heavily speciated and specialized production environment
that operates 24x7x365.</p><p>As this infrastructure is migrated from a largely on-premise data-centre
based environment to a cloud native environment and the wider technology
organization it operates within doubles in size, change is inevitable.
You can bet your roadmap on it.</p><p>One great emerging de facto standard is the observability sub-domain
that cloud-native computing is propelling forward with standards such as
the CNCF’s OpenTelemetry.</p><p>Tremor added initial support for OpenTelemetry in February 2021.  </p><p>For decades, observability - whether logging, metrics or distributed
tracing has been common. But, lacking in a unified approach, lacking in
a core set of interoperable and interworking standards.</p><p>OpenTelemetry has good support for capturing and distributing logs,
metrics and trace spans. It has sufficient out of the box to suit the
most common needs, most of the time. It affords developers an
opportunity to rationalize libraries and frameworks around shared
concepts, shared understanding and shared effort. This is especially
valuable in large, complex production operations such as Wayfair’s
eCommerce production estate.</p><p>Languages and platforms change over time. System and component
infrastructure are continuously evolving. As SaaS environments continue
to evolve and innovate new forms of observability; or production
operations, system reliability engineers or network operations teams who
often need to move faster than the pace of application or infrastructure
developers can develop new software and systems - this is a hard
problem.</p><p>By targeting OpenTelemetry - developers can depend on a consistent set
of SDKs for most common observability needs. Production focused teams
can depend on a consistent wire-format and protocol allowing them to
move from data-centre to the cloud, and rewire the infrastructure and
services just in time.  </p><p>Through OpenTelemetry, we can normalize the concepts, the code and the
inner workings of our cloud-based systems and services - whilst
introducing far more flexibility than ever before as observability
services and software vendors provide a standards-based and
interoperable path.  </p><p>It is a win-win for all concerned.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="required-outcome">Required Outcome<a href="#required-outcome" class="hash-link" aria-label="Direct link to Required Outcome" title="Direct link to Required Outcome">​</a></h2><p><img loading="lazy" alt="High level architecture - current system" src="/assets/images/image1-32716253b3dd4aa772701e3b429e0bc2.png" width="936" height="546" class="img_ev3q"></p><p>In production at Wayfair, logging and metrics data distribution
pipelines are all handled by tremor. With OpenTelemetry, distributed
tracing can now be standardized across our production estate.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a href="#solution" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3><p>Standardize an Tremor and OpenTelemetry together.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="characteristics">Characteristics<a href="#characteristics" class="hash-link" aria-label="Direct link to Characteristics" title="Direct link to Characteristics">​</a></h3><p>The introduction of OpenTelemetry allows developers to standardize on
Observability in applications, services and code for logging, metrics
and distributed tracing. As OpenTelemetry is natively supported in
tremor, it means only minor configuration changes to our existing
logging and metrics services.</p><p><img loading="lazy" alt="The new OpenTelemetry normal" src="/assets/images/image2-ca3c064f5ad4349f47324fcf1e51d363.png" width="958" height="544" class="img_ev3q"></p><p>With OpenTelemetry, distributed tracing can benefit from the same
traffic shaping and adaptive rate limiting as the rest of our
observability stack. The unification of the source, collector and
distribution tiers via kafka provides scalable and recoverable telemetry
shipping and distribution.</p><p>Tremor adds adaptive load shedding and traffic shaping that are tunable
in production. Tremor also allows legacy observability frameworks to
co-exist with OpenTelemetry for a gradual migration across the
programming languages and frameworks in production use. Finally, tremor
enables multiple downstream services to participate in the overall
solution.</p><p>As a heterogeneous ecosystem of interconnected services - the unified
observability platform based on tremor has no preferred upstream or
downstream endpoint. It is system and service agnostic. It is
bendable.  </p><p>This allows teams that prefer the GCP ecosystem to normalize to those
native services for visualization, debugging and troubleshooting. For
our ElasticSearch population, Elastic’s APM may be a better alternative.
For other teams, and our operational staff and folk with more ad hoc
needs - DataDog may be preferable.</p><p>It’s a cloud native decentralized rock’n’roll observability world out
there. Getting 5000 and growing engineers to choose a single
observability path is impossible. So, as the population cannot bend, the
unified observability leans on tremor for this purpose.</p><p>As improved services, frameworks and methods are onboarded our
tremor-based systems can be incrementally adjusted to meet changing
demands.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="insights">Insights<a href="#insights" class="hash-link" aria-label="Direct link to Insights" title="Direct link to Insights">​</a></h3><p>This application of tremor does not introduce new features or
capabilities per se.</p><p>However, it is the first unified tremor-based system that spans the
entire observability spectrum. It centralizes common capabilities and
facilities for greater operational freedom, whilst decentralizing the
point-to-point endpoint connectivity for the widest applicability across
our production estate.</p><p>As tremor exposes OpenTelemetry as a client, and as an embedded server -
it is effectively used to disintermediate, interpose and intework with
legacy environments and to standardise on OpenTelemetry.  </p><p>It does this as an incremental update. Existing users have time to
migrate their systems to the new OpenTelemetry-based best-practice.
Existing processes, practices and battle-tested systems are
maintained.  </p><p>Operators have better tools to manage the production estate and to tune
capacity, performance and cost.</p><p>This is also the first tremor-based system where tremor is a key
architectural primitive allowing our observability community to
bend to the changing needs of our development and operational community
with minimal effort, and at short notice.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>As tremor expands to new domains such as search, service orchestration
and supply-chain and logistics to name but a few - our early adopters in
the logging domain have evolved from using tremor as a point solution
for traffic shaping - to building our entire observability
infrastructure based on tremor.  </p><p>New domains will extend tremor’s capabilities in multi-participant
transaction processing and distributed orchestration. The now unified
observability domain will further expand and extract capabilities that
enhance modularity and flexibility of tremor to build large distributed
systems with a relatively simple and easy to program and growing set of
languages designed for large-scale event-based processing.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/case-study">case-study</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wayfair">wayfair</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/page/2"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chat.tremor.rs/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/TremorDEBS" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Media</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/channel/UCg1hxwEjh9szpYg8SxL0U7Q" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
          Copyright © 2025, Tremor Authors | Documentation Distributed under CC-BY-4.0.<br><br>
              <p style="font-size: smaller;">Hosted by: <a href="https://www.netlify.com/" rel="noreferrer noopener" aria-label="Netlify"><img src="/img/netlify-full-logo.svg" alt="CNCF" style="width: 3%;"></a>
              &nbsp;&nbsp;&nbsp;&nbsp;
              Project of: <a href="https://www.cncf.io/" rel="noreferrer noopener" aria-label="CNCF"><img src="/img/cncf-color.svg" alt="CNCF" style="width: 5%;"></a></p>
        <small>© 2025 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a> page.</small>
        </div></div></div></footer></div>
<script src="/assets/js/runtime~main.0a24082e.js"></script>
<script src="/assets/js/main.fe542851.js"></script>
</body>
</html>