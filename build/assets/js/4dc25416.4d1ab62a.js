"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[2390],{12521:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var i=a(58168),o=(a(96540),a(15680));const n={title:"Case Study - Dead Code Detection in PHP",tags:["case-study","wayfair"],author:"Ramona \u0141uczkiewicz",author_url:"https://github.com/Agares",author_image_url:"https://avatars.githubusercontent.com/u/303398?v=4",image:"./media/wayfair.png",draft:!1,hide_table_of_contents:!1},r="Dead Code Detection in PHP",s={permalink:"/blog/2021/11/09/php-dead-code-detection",editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/blog/2021-11-09-php-dead-code-detection.md",source:"@site/blog/2021-11-09-php-dead-code-detection.md",title:"Case Study - Dead Code Detection in PHP",description:"Identified Need",date:"2021-11-09T00:00:00.000Z",formattedDate:"November 9, 2021",tags:[{label:"case-study",permalink:"/blog/tags/case-study"},{label:"wayfair",permalink:"/blog/tags/wayfair"}],readingTime:1.185,hasTruncateMarker:!1,authors:[{name:"Ramona \u0141uczkiewicz",url:"https://github.com/Agares",imageURL:"https://avatars.githubusercontent.com/u/303398?v=4"}],frontMatter:{title:"Case Study - Dead Code Detection in PHP",tags:["case-study","wayfair"],author:"Ramona \u0141uczkiewicz",author_url:"https://github.com/Agares",author_image_url:"https://avatars.githubusercontent.com/u/303398?v=4",image:"./media/wayfair.png",draft:!1,hide_table_of_contents:!1},prevItem:{title:"Connectors for Streaming to AWS S3",permalink:"/blog/2021/12/04/LFX-Blog-Daksh"},nextItem:{title:"Case Study - Unified Observability Platform",permalink:"/blog/2021/11/08/uop"}},d={image:a(21697).A,authorsImageUrls:[void 0]},c=[{value:"Identified Need",id:"identified-need",level:2},{value:"Required Outcome",id:"required-outcome",level:2},{value:"Characteristics",id:"characteristics",level:2},{value:"Conclusion",id:"conclusion",level:2}],l={toc:c},u="wrapper";function h(e){let{components:t,...n}=e;return(0,o.yg)(u,(0,i.A)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h2",{id:"identified-need"},"Identified Need"),(0,o.yg)("p",null,"We have a humongous PHP application - around 20 million lines of code. It\u2019s believed that there are certain parts of the codebase that are no longer used, but it\u2019s hard to reliably find out which ones. Due to the dynamic nature of PHP, attempts at static analysis have failed. We decided that dynamic analysis was needed, and created a PHP extension that logs all the calls to all functions and methods. That\u2019s a lot of data, and we used tremor to aggregate it."),(0,o.yg)("h2",{id:"required-outcome"},"Required Outcome"),(0,o.yg)("p",null,"We need to be able to aggregate a lot of data (the extension sends one message for each HTTP request, which can be at the order of hundreds per second for some servers), counting the number of calls to each function or method in the codebase and send it to our service which does further aggregation and presents the data.\n",(0,o.yg)("img",{alt:"High Level Architecture",src:a(30886).A,width:"4810",height:"910"})),(0,o.yg)("h2",{id:"characteristics"},"Characteristics"),(0,o.yg)("p",null,"We used Unix Sockets (which were added as a source to tremor during this project) and then a simple script that aggregates the data. We\u2019re hoping to use custom aggregate functions in the future (there\u2019s an open RFC, waiting for the official voting) to further simplify the pipeline."),(0,o.yg)("h2",{id:"conclusion"},"Conclusion"),(0,o.yg)("p",null,"We are currently testing the solution with smaller applications, seeing minimal performance impact and no impact on stability. We were able to delete unused code from those applications without affecting their operation."))}h.isMDXComponent=!0},30886:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/dead_code_detection_diagram-ed8ac4fbb8b9c7d345902e0c616d0bfc.png"},21697:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/wayfair-b0bafac5cf230fcd5e29c8cb4560c334.png"}}]);