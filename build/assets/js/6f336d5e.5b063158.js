"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[6697],{56756:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=t(58168),r=(t(96540),t(15680)),i=t(40281);const o={},l="Grammar",s={unversionedId:"language/reference/index",id:"version-0.12/language/reference/index",title:"Grammar",description:"Tremor contains a number of related domain specific languages that are",source:"@site/versioned_docs/version-0.12/language/reference/index.md",sourceDirName:"language/reference",slug:"/language/reference/",permalink:"/docs/0.12/language/reference/",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.12/language/reference/index.md",tags:[],version:"0.12",frontMatter:{},sidebar:"indexSidebar",previous:{title:"Expressions",permalink:"/docs/0.12/language/expressions"},next:{title:"EBNF",permalink:"/docs/0.12/language/reference/EBNF"}},p={},d=[{value:"High Level Overview",id:"high-level-overview",level:2},{value:"UNIX philosophy",id:"unix-philosophy",level:2},{value:"Scripting",id:"scripting",level:3},{value:"Querying",id:"querying",level:3},{value:"Deploying",id:"deploying",level:3},{value:"Running",id:"running",level:3},{value:"Modularity",id:"modularity",level:3},{value:"Module system",id:"module-system",level:2}],m={toc:d},g="wrapper";function u(e){let{components:n,...t}=e;return(0,r.yg)(g,(0,a.A)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"grammar"},"Grammar"),(0,r.yg)("p",null,"Tremor contains a number of related domain specific languages that are\ndesigned to simplify development and operations of event based production\nsystems."),(0,r.yg)("p",null,"Tremor provides an expression oriented scripting language that is optimized\nfor transforming nested heirarchic data structures with a rich suite of\ndata transformation operations on nominal ( named ) record ( object ),\narray ( list, set ) and primitive ( string, integral, floating point, boolean )\ndata types."),(0,r.yg)("p",null,"Tremor provides a statement oriented query like language that embeds the\nscripting language that is flow oriented. Tremor queries are compiled to\ndirected-acyclic graphs represent streaming transformations based on builtin\noperations such as ",(0,r.yg)("inlineCode",{parentName:"p"},"select")," queries, or custom user defined scripted operations\nvia the ",(0,r.yg)("inlineCode",{parentName:"p"},"script")," operator."),(0,r.yg)("p",null,"Tremor provides a statement oriented deployment language that embeds\nthe query and scripting langauges allows complex flows composed of\nquery pipelines, and connectors to external data sources and streams\nto be interconnected and deployed into the tremor runtime."),(0,r.yg)("h2",{id:"high-level-overview"},"High Level Overview"),(0,r.yg)(i.K,{chart:"graph LR\n    D[troy] --\x3e|Embeds| Q(snot)\n    Q[trickle] --\x3e |Embeds| S{Let me think}\n    S[tremor]",mdxType:"Mermaid"}),(0,r.yg)("h2",{id:"unix-philosophy"},"UNIX philosophy"),(0,r.yg)("p",null,"Tremor follows UNIX philosophy. The scripting langauge encapsulates\nthe computation and manipulation of events. The query language composes\nmultiple streams of events into event processing graphs. The deployment\nlanguage connects the outside world to event flow applications in units\nof deployment called a flow."),(0,r.yg)("h3",{id:"scripting"},"Scripting"),(0,r.yg)("p",null,"The simplest useful operation in an event based system is to pass an\ninbound event in real time from some stream of origin to some target\nstream preserving the event data."),(0,r.yg)("p",null,"In the scripting language this is a 1 line program:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},"event\n")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"event")," keyword in tremor represents the current event being processed."),(0,r.yg)("h3",{id:"querying"},"Querying"),(0,r.yg)("p",null,"In the query language, this is also a 1 line program:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-trickle"},"select event from in into out;\n")),(0,r.yg)("p",null,"Visually, this might render as follows:"),(0,r.yg)(i.K,{chart:"graph LR\n    input[in] --\x3e|from| process(event)\n    process[event] --\x3e |into| output\n    output[out]",mdxType:"Mermaid"}),(0,r.yg)("p",null,"The event originates at a standard builtin stream called ",(0,r.yg)("inlineCode",{parentName:"p"},"in")," and\nis distributed to a standard builtin stream called ",(0,r.yg)("inlineCode",{parentName:"p"},"out"),"."),(0,r.yg)("h3",{id:"deploying"},"Deploying"),(0,r.yg)("p",null,"In the deployment language, this is slightly longer:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-troy"},'###\n### A simple console echo application\n### Given json input line by line on stdin\n### Produces json input line by lin on stdout\n### Preserving order of events in distribution order\n###\n\ndefine flow main\nflow\n  # Define a pipeline with our passthrough logic\n  define pipeline passthrough\n  pipeline\n    select event from in into out;\n  end;\n\n  # Define a connector that can read from stdin, write to stdio\n  # and expects line delimited json messages\n  define connector console from stdio\n  with\n    codec = "json",\n    preprocessors = ["lines"],\n    postprocessors = ["lines"],\n  end;\n\n  create connector out from console;       # Our output to `stdout`\n  create connector in from console;        # Our input from `stdin`\n  create pipeline main from passthrough;   # Our application\n\n  connect /connector/in to /pipeline/main;  # Connect stdout to the app\n  connect /pipeline/main to /connector/out; # Connect the app to stdout\n\nend;\n\n# The deploy command does all the work\ndeploy flow main;\n')),(0,r.yg)("p",null,"Although the command that instructs tremor to deploy our 2 instances\nof the ",(0,r.yg)("inlineCode",{parentName:"p"},"stdio")," connector and our query application pipeline is a single\nline, the flow ",(0,r.yg)("inlineCode",{parentName:"p"},"main")," is a reusable template. So we can store our flow\nin a separate file and reuse the definitions."),(0,r.yg)("p",null,"In fact, we have much more flexibility than this. We could further\nmodularise by separating the definitions of ",(0,r.yg)("inlineCode",{parentName:"p"},"pipeline"),"s and ",(0,r.yg)("inlineCode",{parentName:"p"},"connector"),"s\nfrom their use in ",(0,r.yg)("inlineCode",{parentName:"p"},"flow")," definitions."),(0,r.yg)("p",null,"This would enable us to have the same logic with different connectivity.\nPerhaps instead of the console ( useful for developing and debugging ) we\nmight wish to use kafka connectors. Perhaps our kafka configuration will\nbe different depending on whether we're in a staging, development or production environment. Perhaps we are migrating from a legacy kafka cluster\nto a high performance ",(0,r.yg)("inlineCode",{parentName:"p"},"redpanda")," Kafka compatible cluster."),(0,r.yg)("p",null,"We can compose many different variants and reuse the parts as appropriate."),(0,r.yg)("p",null,"All of these possible ",(0,r.yg)("inlineCode",{parentName:"p"},"flow")," variants have a similar structure:"),(0,r.yg)(i.K,{chart:"graph LR\n    input[in] --\x3e|connect| pipeline(main)\n    pipeline[events] --\x3e |connect| output\n    output[out]",mdxType:"Mermaid"}),(0,r.yg)("h3",{id:"running"},"Running"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},'$ tremor server run echo.troy\n> tremor version: 0.12\n> tremor instance: tremor\n> rd_kafka version: 0x000002ff, 1.8.2\n> allocator: snmalloc\n> Listening at: http://0.0.0.0:9898\n> 1\n< 1\n> {}\n< {}\n> "snot"\n< "snot"\n')),(0,r.yg)("h3",{id:"modularity"},"Modularity"),(0,r.yg)("p",null,"All tremor DSLs share a common set of compiler and runtime infrastructure."),(0,r.yg)("p",null,"The module system is itself defined as a ",(0,r.yg)("a",{parentName:"p",href:"module_system"},"tremor-module")," DSL."),(0,r.yg)("p",null,"The primary domain specific languages are:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Guide"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"),(0,r.yg)("th",{parentName:"tr",align:null},"Extension"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"[tremor-module",(0,r.yg)("a",{parentName:"td",href:"module_system"})),(0,r.yg)("td",{parentName:"tr",align:null},"- The tremor module system."),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"none"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"deploy"},"tremor-deploy")),(0,r.yg)("td",{parentName:"tr",align:null},"- The tremor deployment language."),(0,r.yg)("td",{parentName:"tr",align:null},"troy")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"query"},"tremor-query")),(0,r.yg)("td",{parentName:"tr",align:null},"- The tremor query language."),(0,r.yg)("td",{parentName:"tr",align:null},"trickle")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"script"},"tremor-script")),(0,r.yg)("td",{parentName:"tr",align:null},"- the tremor scripting language."),(0,r.yg)("td",{parentName:"tr",align:null},"script")))),(0,r.yg)("h2",{id:"module-system"},"Module system"),(0,r.yg)("p",null,"The DSLs in tremor share a common module system. The module system allows\nmultiple modular scripts to be loaded via one or many mount points. Each\nmount point provides a heirarchy of modules where nesting and namespacing\nis indicated by the relative folder structure, including the file's basename."),(0,r.yg)("p",null,"Scripts can load other scripts.\nQueries can load scripts, and other queries.\nDeployments can load queries, can load scripts and can load other deployments."),(0,r.yg)(i.K,{chart:"graph LR\n    A[troy] --\x3e|Uses| D(module system)\n    B[trickle] --\x3e |Uses| D\n    C[script] --\x3e |Uses| D\n    A[troy] --\x3e|Embeds| B\n    B[trickle] --\x3e |Embeds| C",mdxType:"Mermaid"}))}u.isMDXComponent=!0}}]);