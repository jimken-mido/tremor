"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[1018],{88473:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=t(58168),r=(t(96540),t(15680));t(40281);const i={},o="grouper::bucket",s={unversionedId:"reference/operators/bucket",id:"version-0.12/reference/operators/bucket",title:"grouper::bucket",description:"Bucket will perform a sliding window rate limiting based on event metadata. Limits are applied for every $class. In a $class each $dimensions is allowed to pass $rate messages per second.",source:"@site/versioned_docs/version-0.12/reference/operators/bucket.md",sourceDirName:"reference/operators",slug:"/reference/operators/bucket",permalink:"/docs/0.12/reference/operators/bucket",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.12/reference/operators/bucket.md",tags:[],version:"0.12",frontMatter:{},sidebar:"indexSidebar",previous:{title:"generic::batch",permalink:"/docs/0.12/reference/operators/batch"},next:{title:"generic::counter",permalink:"/docs/0.12/reference/operators/counter"}},l={},p=[],m={toc:p},u="wrapper";function c(e){let{components:n,...t}=e;return(0,r.yg)(u,(0,a.A)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"grouperbucket"},"grouper::bucket"),(0,r.yg)("p",null,"Bucket will perform a sliding window rate limiting based on event metadata. Limits are applied for every ",(0,r.yg)("inlineCode",{parentName:"p"},"$class"),". In a ",(0,r.yg)("inlineCode",{parentName:"p"},"$class")," each ",(0,r.yg)("inlineCode",{parentName:"p"},"$dimensions")," is allowed to pass ",(0,r.yg)("inlineCode",{parentName:"p"},"$rate")," messages per second."),(0,r.yg)("p",null,"This operator does not support configuration."),(0,r.yg)("p",null,"This operator preserves event metadata."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Metadata Variables"),":"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"$class")," - The class of an event. (String)"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"$rate")," - Allowed events per second per class/dimension (Number)"),(0,r.yg)("li",{parentName:"ul"},"(Optional) ",(0,r.yg)("inlineCode",{parentName:"li"},"$dimensions")," - The dimensions of the event. (Any)"),(0,r.yg)("li",{parentName:"ul"},"(Optional)",(0,r.yg)("inlineCode",{parentName:"li"},"$cardinality")," - the maximum number of dimensions kept track of at the same time (Number, default: ",(0,r.yg)("inlineCode",{parentName:"li"},"1000"),")")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Outputs"),":"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"out")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"error")," - Unprocessable events for example if ",(0,r.yg)("inlineCode",{parentName:"li"},"$class")," or ",(0,r.yg)("inlineCode",{parentName:"li"},"$rate")," are not set."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"overflow")," - Events that exceed the rate defined for them")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Example"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},"define operator group from grouper::bucket;\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Metrics"),":"),(0,r.yg)("p",null,"The bucket operator generates additional metrics. For each class the following two statistics are generated (as an example):"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{"measurement":"bucketing",\n "tags":{\n   "action":"pass",\n   "class":"test",\n   "direction":"output",\n   "node":"bucketing",\n   "pipeline":"main",\n   "port":"out"\n },\n "fields":{"count":93},\n "timestamp":1553012903452340000\n}\n{"measurement":"bucketing",\n "tags":{\n   "action":"overflow",\n   "class":"test",\n   "direction":"output",\n   "node":"bucketing",\n   "pipeline":"main",\n   "port":"out"\n },\n "fields":{"count":127},\n "timestamp":1553012903452340000\n}\n')),(0,r.yg)("p",null,"This tells us the following, up until this measurement was published in the class ",(0,r.yg)("inlineCode",{parentName:"p"},"test"),":"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"(",(0,r.yg)("inlineCode",{parentName:"li"},"pass"),") Passed 93 events"),(0,r.yg)("li",{parentName:"ul"},"(",(0,r.yg)("inlineCode",{parentName:"li"},"overflow"),") Marked 127 events as overflow due to not fitting in the limit")))}c.isMDXComponent=!0}}]);