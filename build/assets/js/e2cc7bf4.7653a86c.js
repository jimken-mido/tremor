"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[1126],{58374:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var a=t(58168),i=(t(96540),t(15680));t(40281);const s={},o="Passthrough",r={unversionedId:"recipes/passthrough/index",id:"version-0.11/recipes/passthrough/index",title:"Passthrough",description:"All the application code here is available from the docs git repository.",source:"@site/versioned_docs/version-0.11/recipes/00_passthrough/index.md",sourceDirName:"recipes/00_passthrough",slug:"/recipes/passthrough/",permalink:"/docs/0.11/recipes/passthrough/",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/recipes/00_passthrough/index.md",tags:[],version:"0.11",frontMatter:{},sidebar:"version-0.11/tutorialSidebar",previous:{title:"Recipes",permalink:"/docs/0.11/recipes/"},next:{title:"Filter",permalink:"/docs/0.11/recipes/filter/"}},p={},l=[{value:"Environment",id:"environment",level:2},{value:"Business Logic",id:"business-logic",level:2},{value:"Command line testing during logic development",id:"command-line-testing-during-logic-development",level:2}],g={toc:l},d="wrapper";function c(e){let{components:n,...s}=e;return(0,i.yg)(d,(0,a.A)({},g,s,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"passthrough"},"Passthrough"),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"All the application code here is available from the docs ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/recipes/00_passthrough/index.md"},"git repository"),".")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"passthrough")," example is the simplest possible configuration of tremor. It shows the very basic building blocks: Onramp, Offramp, Binding, Mapping and Pipeline."),(0,i.yg)("h2",{id:"environment"},"Environment"),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(18594).A},"onramp")," we use is a websocket onramp listening on port 4242, it receives ",(0,i.yg)("inlineCode",{parentName:"p"},"JSON")," formatted messages."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-yaml"},'onramp:\n  - id: ws-input # A unique id for binding/mapping\n    type: ws # The unique type descriptor for the onramp ( websocket server here)\n    codec: json # The underlying data format expected for application payload data\n    config:\n      port: 4242 # The TCP port to listen on\n      host: "0.0.0.0" # The IP address to bind on ( all interfaces in this case )\n')),(0,i.yg)("p",null,"It connects to the pipeline ",(0,i.yg)("inlineCode",{parentName:"p"},"example")," in the ",(0,i.yg)("a",{target:"_blank",href:t(88815).A},(0,i.yg)("code",null,"example.trickle"))," file using the trickle query language to express its logic."),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(18594).A},"offramp")," we used is a console offramp producing to standard output. It receives ",(0,i.yg)("inlineCode",{parentName:"p"},"JSON")," formatted messages."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-yaml"},'offramp:\n  - id: stdout-output # The unique id for binding/mapping\n    type: stdout # The unique type descriptor for the offramp ( stdout here )\n    codec: json # The underlying data format expected for application payload data\n    config:\n      prefix: ">> " # A prefix for data emitted on standard output by this offramp\n')),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(27325).A},"binding")," expresses those relations and gives the graph of onramp, pipeline and offramp."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-yaml"},'binding:\n  - id: example # The unique name of this binding template\n    links:\n      "/onramp/ws-input/{instance}/out": # Connect the input to the pipeline\n        - "/pipeline/example/{instance}/in"\n      "/pipeline/example/{instance}/out": # Connect the pipeline to the output\n        - "/offramp/stdout-output/{instance}/in"\n')),(0,i.yg)("p",null,"Finally the ",(0,i.yg)("a",{target:"_blank",href:t(61963).A},"mapping")," instanciates the binding with the given name and instance variable to activate the elements of the binding."),(0,i.yg)("h2",{id:"business-logic"},"Business Logic"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-trickle"},"select event from in into out\n")),(0,i.yg)("h2",{id:"command-line-testing-during-logic-development"},"Command line testing during logic development"),(0,i.yg)("p",null,"Run a the passthrough query against a sample input.json"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},'$ tremor run -i input.json etc/tremor/config/example.trickle\n{"hello": "world"}\n')),(0,i.yg)("p",null,"Deploy the solution into a docker environment"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},'$ docker-compose up\n>> {"hello": "world", "selected": false}\n>> {"hello": "again", "selected": true}\n')),(0,i.yg)("p",null,"Inject test messages via ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/vi/websocat"},"websocat")),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Can be installed via ",(0,i.yg)("inlineCode",{parentName:"p"},"cargo install websocat")," for the lazy/impatient amongst us")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},"$ cat inputs.txt | websocat ws://localhost:4242\n...\n")))}c.isMDXComponent=!0},18594:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/files/00_ramps-ab6f76c516e7c0bbd9a5e6c81a5d1e0b.yaml"},27325:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/files/01_binding-afcd7be44955ce5863173182e6582008.yaml"},61963:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/files/02_mapping-166e97a9934692095253b74667464d4d.yaml"},88815:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/files/example-a5bc721242b579503e73a6e7cda4ec32.trickle"}}]);