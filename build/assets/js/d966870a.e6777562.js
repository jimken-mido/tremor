"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[6040],{69338:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var t=i(58168),a=(i(96540),i(15680));i(40281);const r={},o="PostgreSQL TimescaleDB",s={unversionedId:"recipes/postgres_timescaledb/index",id:"version-0.11/recipes/postgres_timescaledb/index",title:"PostgreSQL TimescaleDB",description:"All the application code here is available from the docs git repository.",source:"@site/versioned_docs/version-0.11/recipes/12_postgres_timescaledb/index.md",sourceDirName:"recipes/12_postgres_timescaledb",slug:"/recipes/postgres_timescaledb/",permalink:"/docs/0.11/recipes/postgres_timescaledb/",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/recipes/12_postgres_timescaledb/index.md",tags:[],version:"0.11",frontMatter:{},sidebar:"version-0.11/tutorialSidebar",previous:{title:"Influx",permalink:"/docs/0.11/recipes/influx/"},next:{title:"Grafana",permalink:"/docs/0.11/recipes/grafana/"}},l={},d=[{value:"Environment",id:"environment",level:2},{value:"Business Logic",id:"business-logic",level:2},{value:"Command line testing during logic development",id:"command-line-testing-during-logic-development",level:2},{value:"Discussion",id:"discussion",level:3}],p={toc:d},m="wrapper";function g(e){let{components:n,...r}=e;return(0,a.yg)(m,(0,t.A)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"postgresql-timescaledb"},"PostgreSQL TimescaleDB"),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"All the application code here is available from the docs ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/recipes/12_postgres_timescaledb/index.md"},"git repository"),".")),(0,a.yg)("p",null,"This example demonstrates extracting data from a Postgres database and inserting\ndata to TimescaleDB."),(0,a.yg)("p",null,"The demo starts up said PostgreSQL, TimescaleDB, Tremor and ",(0,a.yg)("inlineCode",{parentName:"p"},"pgweb"),"."),(0,a.yg)("h2",{id:"environment"},"Environment"),(0,a.yg)("p",null,"In ",(0,a.yg)("a",{target:"_blank",href:i(46526).A},(0,a.yg)("code",null,"00_ramps.yaml"))," we pass in a\nconfiguration for an onramp of type ",(0,a.yg)("inlineCode",{parentName:"p"},"postgres")," along with typical connection\nstring requirements."),(0,a.yg)("p",null,"Additionally, we are required to specify ",(0,a.yg)("inlineCode",{parentName:"p"},"interval_ms")," which stands for\nfrequency of polling that Tremor is performing on Postgres database with the\ngiven ",(0,a.yg)("inlineCode",{parentName:"p"},"query"),". Query will be passed two parameters:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"$1")," is the ",(0,a.yg)("inlineCode",{parentName:"li"},"TIMESTAMPTZ")," that indicates the start time and date for the\nrange"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"$2")," is the ",(0,a.yg)("inlineCode",{parentName:"li"},"TIMESTAMPTZ")," that indicates the ending time and date for the\nrange")),(0,a.yg)("p",null,"The initial range is formed by taking ",(0,a.yg)("inlineCode",{parentName:"p"},"consume_from")," configuration setting and\nthe current time and date. This will effectivelly backfill data. From then on,\nTremor will poll in regular ",(0,a.yg)("inlineCode",{parentName:"p"},"interval_ms"),"."),(0,a.yg)("p",null,"In addition to a ",(0,a.yg)("inlineCode",{parentName:"p"},"postgres")," onramp, we also utilize a ",(0,a.yg)("inlineCode",{parentName:"p"},"crononome")," onramp. The\nintention is to demonstrate intermediate record format which is accepted by\n",(0,a.yg)("inlineCode",{parentName:"p"},"postgres")," offramp."),(0,a.yg)("h2",{id:"business-logic"},"Business Logic"),(0,a.yg)("p",null,"We have two pipelines."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{target:"_blank",href:i(32962).A},(0,a.yg)("code",null,"postgres.trickle"))," for data coming from a PostgreSQL database"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{target:"_blank",href:i(17933).A},(0,a.yg)("code",null,"crononome.trickle"))," for events coming from the ",(0,a.yg)("inlineCode",{parentName:"li"},"crononome")," onramp at a regular interval of ",(0,a.yg)("inlineCode",{parentName:"li"},"5s"),".")),(0,a.yg)("h2",{id:"command-line-testing-during-logic-development"},"Command line testing during logic development"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"$ docker-compose up\n  ... lots of logs ...\n")),(0,a.yg)("p",null,"Open the ",(0,a.yg)("a",{parentName:"p",href:"http://localhost:8081"},"pgweb")," to browse through received rows in\nTimescaleDB."),(0,a.yg)("h3",{id:"discussion"},"Discussion"))}g.isMDXComponent=!0},46526:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/00_ramps-c5f0d574f0fc74dfa0a7f9fe360f49cc.yaml"},17933:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/crononome-4a67da5b67f44d0defe99bb0630f8f31.trickle"},32962:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/postgres-9317f3359d6ae14e610ea840f0633d9e.trickle"}}]);