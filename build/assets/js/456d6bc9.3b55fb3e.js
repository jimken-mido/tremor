"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[856],{47547:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var r=t(58168),a=(t(96540),t(15680));const i={},s="Linked Transports",o={unversionedId:"implemented/linked-transports",id:"implemented/linked-transports",title:"Linked Transports",description:"- Feature Name: rfc0003linked_transports",source:"@site/rfc/implemented/0003-linked-transports.md",sourceDirName:"implemented",slug:"/implemented/linked-transports",permalink:"/rfc/implemented/linked-transports",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/rfc/implemented/0003-linked-transports.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Remove Actix",permalink:"/rfc/implemented/remove-actix-from-tremor-runtime"},next:{title:"Circuit Breaker Mechanism",permalink:"/rfc/implemented/circuit-breaker-mechanism"}},l={},p=[{value:"Summary",id:"summary",level:2},{value:"Motivation",id:"motivation",level:2},{value:"Guide-level Explanation",id:"guide-level-explanation",level:2},{value:"Reference-level Explanation",id:"reference-level-explanation",level:2},{value:"Drawbacks",id:"drawbacks",level:2},{value:"Rationale and Alternatives",id:"rationale-and-alternatives",level:2},{value:"Prior Art",id:"prior-art",level:2},{value:"Unresolved Questions",id:"unresolved-questions",level:2},{value:"Future Possibilities",id:"future-possibilities",level:2}],m={toc:p},d="wrapper";function u(e){let{components:n,...t}=e;return(0,a.yg)(d,(0,r.A)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"linked-transports"},"Linked Transports"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Feature Name: rfc_0003_linked_transports"),(0,a.yg)("li",{parentName:"ul"},"Start Date: 2020-01-27"),(0,a.yg)("li",{parentName:"ul"},"Issue: ",(0,a.yg)("a",{parentName:"li",href:"https://github.com/tremor-rs/tremor-rfcs/issues/5"},"tremor-rs/tremor-rfcs#0005")),(0,a.yg)("li",{parentName:"ul"},"RFC PR: ",(0,a.yg)("a",{parentName:"li",href:"https://github.com/tremor-rs/tremor-rfcs/pull/6"},"tremor-rs/tremor-rfcs#0006"))),(0,a.yg)("h2",{id:"summary"},"Summary"),(0,a.yg)("p",null,"The tremor-runtime supports ingress from and egress to external data sources and\nsinks through adapters called ",(0,a.yg)("inlineCode",{parentName:"p"},"Onramps")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"Offramps")," accordingly."),(0,a.yg)("p",null,"There is no mechanism currently that allows the underlying transport encapsulated by ",(0,a.yg)("inlineCode",{parentName:"p"},"Onramps")," or ",(0,a.yg)("inlineCode",{parentName:"p"},"Offramps")," to share their respective underlying connections."),(0,a.yg)("p",null,"This RFC addresses these limitations by introducing ",(0,a.yg)("inlineCode",{parentName:"p"},"linked transports")," notionally and allowing ",(0,a.yg)("inlineCode",{parentName:"p"},"Onramp")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"Offramp")," specifications to reference a common shared underlying transport instance by reference."),(0,a.yg)("h2",{id:"motivation"},"Motivation"),(0,a.yg)("p",null,"The absence of linked transports prohibits authors of tremor-script/tremor-query\nfrom writing proxy applications where request/response style interactions can be\nrouted from a client request back to a client response in the same synchronous blocking RPC transport connection context back to the originating ephemeral client."),(0,a.yg)("p",null,"This limitation also requires having multiple messaging endpoint connections for asynchronous communications when a single connection may be sufficient."),(0,a.yg)("h2",{id:"guide-level-explanation"},"Guide-level Explanation"),(0,a.yg)("p",null,"Given a linked transport configuration:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"transport:\n  - id: rest\n    codec: json\n    config:\n      port: 8080\n      listen:\n          - 0.0.0.0\n      headers:\n        'Content-type': 'application/json'\n      methods:\n        '/api/{id}': [ 'GET', 'POST', 'PUT', 'PATCH', 'DELETE' ]\n")),(0,a.yg)("p",null,"An onramp referencing the transport:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"onramp:\n  - id: rest_inbound\n    ref: rest\n")),(0,a.yg)("p",null,"An offramp referencing the same transport:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"offramp:\n  - id: rest_outbound\n    ref: rest\n")),(0,a.yg)("p",null,"Then, user defined logic in the script or query language can fully proxy or implement services for the underlying transport:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-tremor"},'match event of\n  case %{ path == "/api/{id}", method == "GET" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "POST" } => { "id": "{event.params.id}", "status": 201 },\n  case %{ path == "/api/{id}", method == "PUT" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "PATCH" } => { "id": "{event.params.id}", "status": 200 },\n  case %{ path == "/api/{id}", method == "DELETE" } => { "id": "{event.params.id}", "status": 204 },\n  default => { "error": "Service unavailable", "status": 503 }\nend\n')),(0,a.yg)("p",null,"The binding specification:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"binding:\n  - id: api_gateway\n    links:\n      '/onramp/rest_inbound/{instance}/out': [ '/pipeline/api/{instance}/in' ]\n      '/pipeline/api/{instance}/out': [ '/offramp/rest_outbound/{instance}/in'  ]\n")),(0,a.yg)("p",null,"There is no facility in the current tremor-runtime to describe transport services that effectively implement or proxy an underlying protocol fully as there is no mechanism to intercept a request, process it through a pipeline, and route the response such that it consummates a single transport level request/response or messaging interaction."),(0,a.yg)("p",null,"A shared transport fills this gap and allows the tremor-runtime to implement API gateways, to act as a HTTP router, proxy, reverse proxy and to implement similar capabilities for other transports."),(0,a.yg)("h2",{id:"reference-level-explanation"},"Reference-level Explanation"),(0,a.yg)("p",null,"None."),(0,a.yg)("h2",{id:"drawbacks"},"Drawbacks"),(0,a.yg)("p",null,"None."),(0,a.yg)("h2",{id:"rationale-and-alternatives"},"Rationale and Alternatives"),(0,a.yg)("p",null,"The introduction of transports coupled with adding optional transport references\nto onramp and offramp specifications enables the tremor-runtime to act as a proxy or reverse proxy endpoint with logic implemented in the scripting or query language."),(0,a.yg)("h2",{id:"prior-art"},"Prior Art"),(0,a.yg)("p",null,"None."),(0,a.yg)("h2",{id:"unresolved-questions"},"Unresolved Questions"),(0,a.yg)("p",null,"This RFC does not specify internals or implementation which is left to the implementor. The motiviating example should be sufficient to drive a suitable implementation."),(0,a.yg)("h2",{id:"future-possibilities"},"Future Possibilities"),(0,a.yg)("p",null,"None known at this time."))}u.isMDXComponent=!0}}]);