"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[5640],{23599:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=t(58168),r=(t(96540),t(15680));const o={title:"Releasing Tremor v0.10!",author:"The Tremor Team",author_url:"https://github.com/tremor-rs",author_image_url:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4",tags:["releases"],draft:!1,description:"Releasing Tremor v0.10.",hide_table_of_contents:!1},i=void 0,s={permalink:"/blog/2021/02/12/v010-release",editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/blog/2021-02-12-v010-release.md",source:"@site/blog/2021-02-12-v010-release.md",title:"Releasing Tremor v0.10!",description:"Releasing Tremor v0.10.",date:"2021-02-12T00:00:00.000Z",formattedDate:"February 12, 2021",tags:[{label:"releases",permalink:"/blog/tags/releases"}],readingTime:4.53,hasTruncateMarker:!0,authors:[{name:"The Tremor Team",url:"https://github.com/tremor-rs",imageURL:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4"}],frontMatter:{title:"Releasing Tremor v0.10!",author:"The Tremor Team",author_url:"https://github.com/tremor-rs",author_image_url:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4",tags:["releases"],draft:!1,description:"Releasing Tremor v0.10.",hide_table_of_contents:!1},prevItem:{title:"Google Cloud Storage and Pub/Sub Connectors",permalink:"/blog/2021/06/29/T17-LFX-Blog-Jigyasa-gcloud"},nextItem:{title:"Releasing Tremor v0.9!",permalink:"/blog/2020/10/16/v09-release"}},l={authorsImageUrls:[void 0]},p=[{value:"Summary",id:"summary",level:2},{value:"TL;DR",id:"tldr",level:2},{value:"New Release Artefacts",id:"new-release-artefacts",level:2},{value:"Binary Type and Binary Codec",id:"binary-type-and-binary-codec",level:2},{value:"Elasticsearch Offramp as Linked Transport",id:"elasticsearch-offramp-as-linked-transport",level:2},{value:"String Interpolation Done Right",id:"string-interpolation-done-right",level:2},{value:"Questions/Comments",id:"questionscomments",level:2}],d={toc:p},m="wrapper";function g(e){let{components:n,...o}=e;return(0,r.yg)(m,(0,a.A)({},d,o,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"v0.10",src:t(1805).A,width:"960",height:"936"})),(0,r.yg)("h2",{id:"summary"},"Summary"),(0,r.yg)("p",null,"This release is the last minor release before we start turning Tremor into a truly distributed event processing and data distribution engine. We focused on small things that improve usability and ironed out some rough edges here and there."),(0,r.yg)("h2",{id:"tldr"},"TL;DR"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"We extended our type system and codecs by the ",(0,r.yg)("inlineCode",{parentName:"li"},"binary")," type."),(0,r.yg)("li",{parentName:"ul"},"Elasticsearch offramp now supports Linked Transport."),(0,r.yg)("li",{parentName:"ul"},"String interpolation done right, now with ",(0,r.yg)("inlineCode",{parentName:"li"},"#{}")," instead of just ",(0,r.yg)("inlineCode",{parentName:"li"},"{}")),(0,r.yg)("li",{parentName:"ul"},"Release now includes prebuilt binaries, DEB packages and RPMs")),(0,r.yg)("h2",{id:"new-release-artefacts"},"New Release Artefacts"),(0,r.yg)("p",null,"To make your life easier installing and Tremor more pleasant, we added new release artefacts. We've now got ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-runtime/releases/download/v0.10.0/tremor-0.10.0-x86_64-unknown-linux-gnu.tar.gz"},"prebuilt binaries")," wrapped up in a ",(0,r.yg)("inlineCode",{parentName:"p"},"tar.gz")," for ",(0,r.yg)("inlineCode",{parentName:"p"},"amd64")," linux, ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-runtime/releases/download/v0.10.0/tremor_0.10.0_amd64.deb"},"DEB"),", and ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-runtime/releases/download/v0.10.0/tremor-0.10.0-1.x86_64.rpm"},"RPM")," packages. And, lets not forget our well-known ",(0,r.yg)("a",{parentName:"p",href:"https://hub.docker.com/repository/docker/tremorproject/tremor"},"Docker Image"),"."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"install prebuilt binary",src:t(23032).A,width:"972",height:"620"})),(0,r.yg)("p",null,"We are going to explore more channels for release artefacts in the future to get you up and running with Tremor in no time."),(0,r.yg)("p",null,"In addition to those new release channels, we enabled thin-lto for all builds, which should improve compile-time while providing all the benefits of full link time optimization (LTO). We also link OpenSSL, now statically, to avoid incompatibilities with OpenSSL versions provided by the OS."),(0,r.yg)("h2",{id:"binary-type-and-binary-codec"},"Binary Type and Binary Codec"),(0,r.yg)("p",null,"Tremor is built for handling JSON-like structured data. It can effectively handle wire formats like JSON, YAML, msgpack and many more. We can represent them all with the same internal model of dynamic structured values. One blind spot up to now has been binary data. The reason for this was that most of the aforementioned formats do not support raw binary data (except msgpack). But times have changed."),(0,r.yg)("p",null,"With Tremor, you can now receive, assemble and send binary data. Receiving is done by configuring your onramp of choice with the ",(0,r.yg)("inlineCode",{parentName:"p"},"binary")," codec. Imagine building a HTTP proxy with Tremor, that is not interested in the actual body payload but does its internal routing work only by looking at the headers. Previously, Tremor had to parse and deserialize the whole body payload. Now, it is able to conveniently pass those bytes through without ever touching them, and thus be even faster and more efficient for similar use cases."),(0,r.yg)("p",null,"Here is an example config for the needed onramps and offramps;"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"onramp:\n  - id: http_input\n    type: rest\n    codec: binary\n    linked: true\n    config:\n      host: 0.0.0.0\n      port: 8080\n\nofframp:\n  - id: http_output1\n    type: rest\n    codec: binary\n    linked: true\n    config:\n      endpoint: http://host01.example.com\n      method: GET\n")),(0,r.yg)("p",null,"And here is a very simple corresponding pipeline:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-trickle"},'select event\nfrom in\nwhere $request.method == "GET" && array::contains($request.headers["content-type"], "application/json")\ninto out;\n')),(0,r.yg)("p",null,"You are able to assemble complex binary events from structured data within tremor-script itself, like TCP packets:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"let tcp_packet = <<\n  event.src.port:16,  event.dst.port:16,\n  event.seq:32,\n  event.ack:32,\n  event.offset:4, event.res:4, event.flags:8, event.win:16,\n  event.checksum:16, event.urgent:16,\n  event.data/binary\n>>;\n")),(0,r.yg)("h2",{id:"elasticsearch-offramp-as-linked-transport"},"Elasticsearch Offramp as Linked Transport"),(0,r.yg)("p",null,"We enhanced our ",(0,r.yg)("a",{parentName:"p",href:"https://docs.tremor.rs/artefacts/offramps/#elastic"},(0,r.yg)("inlineCode",{parentName:"a"},"elastic")," offramp")," to emit 1 event back to Tremor for each document indexed to Elasticsearch, be it successful or not. You will get all the Elasticsearch metadata like the ",(0,r.yg)("inlineCode",{parentName:"p"},"_version")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"_id")," of the indexed document and also the whole payload to be indexed, which is especially useful in the face of indexing errors, e.g. from mismatched document schemas."),(0,r.yg)("p",null,"An ",(0,r.yg)("inlineCode",{parentName:"p"},"elastic")," offramp configured like this:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"offramp:\n  - id: elastic\n    type: elastic\n    linked: true\n    config:\n      nodes:\n        - elastic01:9200\n        - elastic02:9200\n        - elastic03:9200\n")),(0,r.yg)("p",null,"will, for an event like this:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{"data": [1, 2, 3]}\n')),(0,r.yg)("p",null,"send you back a response payload like this if everything went well via the offramps ",(0,r.yg)("inlineCode",{parentName:"p"},"out")," port:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{\n    "source": {\n        "event_id": "1:0:0",\n        "origin": "tremor-file://root/data.json"\n    },\n    "payload": {\n        "data": [1, 2, 3]\n    },\n    "success": true\n}\n')),(0,r.yg)("p",null,"with the following document metadata in ",(0,r.yg)("inlineCode",{parentName:"p"},"$elastic"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "TxQutncB0ovN9WdBcg2i",\n    "index": "tremor_test",\n    "doc_type": "_doc",\n    "version": 1\n}\n')),(0,r.yg)("p",null,"And, in case indexing failed, you would get an event like this via the offramps ",(0,r.yg)("inlineCode",{parentName:"p"},"err")," port:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{\n   "source": {\n        "event_id": "1:0:0",\n        "origin": "tremor-file://root/data.json"\n    },\n    "payload": {\n        "data": [1, 2, 3]\n    },\n    "success": false,\n    "error": {\n        "caused_by": {\n            "reason": "Current token (VALUE_NUMBER_INT) not of boolean type\\n at [Source: (byte[])\\"POST //_bulk HTTP/1.1\\r\\ncontent-type: application/json\\r\\ncontent-length: 346\\r\\nuser-agent: reqwest/0.9.24\\r\\naccept: */*\\r\\naccept-encoding: gzip\\r\\nhost: 127.0.0.1:9200\\r\\n\\r\\n{\\"index\\":{\\"_index\\":\\"tremor_test\\",\\"_type\\":\\"_doc\\"}}\\n{\\"data\\":\\"[1, 2, 3]\\"}\\n\\"[truncated 10 bytes]; line: 1, column: 13]",\n            "type": "json_parse_exception"\n        },\n        "reason": "failed to parse field [data] of type [boolean] in document with id \'TxQutncB0ovN9WdBcg2i\'. Preview of field\'s value: \'1\'",\n        "type": "mapper_parsing_exception"}\n}\n')),(0,r.yg)("p",null,"Such an error message will also contain the same metadata behing the ",(0,r.yg)("inlineCode",{parentName:"p"},"$elastic")," metadata key.\nHaving detailed error data and the original payload at hand will enable users to handle success and error in new ways: Retries in case of errors, signalling upstream applications, try something completely different with that event payload."),(0,r.yg)("h2",{id:"string-interpolation-done-right"},"String Interpolation Done Right"),(0,r.yg)("p",null,"We changed the syntax for string interpolation to now use ",(0,r.yg)("inlineCode",{parentName:"p"},"#{}")," for interpolating arbitrary expressions into a string literal, as we discovered some quirks in how it worked before (with ",(0,r.yg)("inlineCode",{parentName:"p"},"{}"),"). Creating JSON object strings ",(0,r.yg)("inlineCode",{parentName:"p"},'{"key": "value"}')," or regex quantifiers ",(0,r.yg)("inlineCode",{parentName:"p"},"[1-9][0-9]{2, 3}")," have been inconvenient to write and there were surprises together with using the ",(0,r.yg)("inlineCode",{parentName:"p"},"string::format")," function."),(0,r.yg)("p",null,"Where we previously had written:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},'let json_string = """\n{{ "key": "value"}}\n""";\nlet regex = "[1-9][0-9]\\{2, 3\\}";\n')),(0,r.yg)("p",null,"we can now express as:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},'let json_string = """\n{ "key": "value"}\n""";\nlet regex = "[1-9][0-9]{2, 3}";\n')),(0,r.yg)("p",null,"which is much better e.g. for templating purposes."),(0,r.yg)("h2",{id:"questionscomments"},"Questions/Comments"),(0,r.yg)("p",null,"On the Community Discord: ",(0,r.yg)("a",{parentName:"p",href:"https://chat.tremor.rs"},"https://chat.tremor.rs")))}g.isMDXComponent=!0},23032:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/2021-02-19_prebuilt_binary-a89e5b823e2cb5e6dbdd817ce0973fc2.gif"},1805:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/tremor-release-0.10-73915b9f37ba2d7d04ff55f8433f1bd3.jpg"}}]);