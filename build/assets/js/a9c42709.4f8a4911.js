"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[1728],{73159:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>p});var n=t(58168),l=(t(96540),t(15680));t(40281);const o={id:"codecs",title:"Codecs"},i="Codecs",r={unversionedId:"artefacts/codecs",id:"version-0.11/artefacts/codecs",title:"Codecs",description:"Codecs are used to describe how to decode data from the wire and encode it back to wire format.",source:"@site/versioned_docs/version-0.11/artefacts/codecs.md",sourceDirName:"artefacts",slug:"/artefacts/codecs",permalink:"/docs/0.11/artefacts/codecs",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.11/artefacts/codecs.md",tags:[],version:"0.11",frontMatter:{id:"codecs",title:"Codecs"},sidebar:"version-0.11/tutorialSidebar",previous:{title:"Monitoring",permalink:"/docs/0.11/operations/monitoring"},next:{title:"Offramps",permalink:"/docs/0.11/artefacts/offramps"}},s={},p=[{value:"Supported Codecs",id:"supported-codecs",level:2},{value:"json",id:"json",level:3},{value:"string",id:"string",level:3},{value:"msgpack",id:"msgpack",level:3},{value:"influx",id:"influx",level:3},{value:"binflux",id:"binflux",level:3},{value:"statsd",id:"statsd",level:3},{value:"yaml",id:"yaml",level:3},{value:"syslog",id:"syslog",level:3}],g={toc:p},m="wrapper";function d(e){let{components:a,...t}=e;return(0,l.yg)(m,(0,n.A)({},g,t,{components:a,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"codecs"},"Codecs"),(0,l.yg)("p",null,"Codecs are used to describe how to decode data from the wire and encode it back to wire format."),(0,l.yg)("h2",{id:"supported-codecs"},"Supported Codecs"),(0,l.yg)("h3",{id:"json"},"json"),(0,l.yg)("p",null,"En- and decodes ",(0,l.yg)("a",{parentName:"p",href:"https://json.org"},"JSON"),", for encoding a minified format is used (excluding newlines and spaces)."),(0,l.yg)("h3",{id:"string"},"string"),(0,l.yg)("p",null,"Treats the event as non structured string. It is required that the input ",(0,l.yg)("strong",{parentName:"p"},"is valid UTF-8")," or the decoding will fail."),(0,l.yg)("h3",{id:"msgpack"},"msgpack"),(0,l.yg)("p",null,(0,l.yg)("a",{parentName:"p",href:"https://msgpack.org"},"Msgpack")," works based on the msgpack binary format that is structurally compatible with JSON."),(0,l.yg)("p",null,"Being a binary format, message pack is significantly more performant and requires less space compared to JSON."),(0,l.yg)("p",null,"It is an excellent candidate to use in tremor to tremor deployments but as well with any offramp that does support this format."),(0,l.yg)("h3",{id:"influx"},"influx"),(0,l.yg)("p",null,"En- and decodes the ",(0,l.yg)("a",{parentName:"p",href:"https://docs.influxdata.com/influxdb/v1.7/write_protocols/line_protocol_tutorial/"},"influx line protocol"),". The structural representation of the data is as follows:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-text"},"weather,location=us-midwest temperature=82 1465839830100400200\n")),(0,l.yg)("p",null,"translates to:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "measurement": "weather",\n  "tags": { "location": "us-midwest" },\n  "fields": { "temperature": 82.0 },\n  "timestamp": 1465839830100400200\n}\n')),(0,l.yg)("h3",{id:"binflux"},"binflux"),(0,l.yg)("p",null,"The ",(0,l.yg)("inlineCode",{parentName:"p"},"binflux")," codec is a binary representation of influx data that is significantly faster encodes and decodes as well as takes less space on the wire."),(0,l.yg)("p",null,"The format itself does not include framing but can be used with the ",(0,l.yg)("inlineCode",{parentName:"p"},"size-prefix")," pre/post processors."),(0,l.yg)("p",null,"For all numbers network byte order is used (big endian). The data is represented as follows:"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) length of the ",(0,l.yg)("inlineCode",{parentName:"li"},"measurement")," in bytes"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"n byte")," (utf8) the measurement (utf8 encoded string)"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"8 byte")," (u64) the timestamp"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) number of tags (key value pairs) repetitions of:",(0,l.yg)("ol",{parentName:"li"},(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) length of the tag name in bytes"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"n byte")," (utf8) tag name (utf8 encoded string)"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) length of tag value in bytes"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"n byte")," (utf8) tag value (utf8 encoded string)"))),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) number of fiends (key value pairs) repetition of:",(0,l.yg)("ol",{parentName:"li"},(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) length of the tag name in bytes"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"n byte")," (utf8) tag name (utf8 encoded string)"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("em",{parentName:"li"},"1 byte")," (tag) type of the field value can be one of:"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"TYPE_I64 = 0")," followed by ",(0,l.yg)("em",{parentName:"li"},"8 byte")," (i64)",(0,l.yg)("ol",{parentName:"li"},(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"TYPE_F64 = 1")," followed by ",(0,l.yg)("em",{parentName:"li"},"8 byte")," (f64)"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"TYPE_TRUE = 2")," no following data"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"TYPE_FALSE = 3")," no following data"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"TYPE_STRING = 4")," followed by ",(0,l.yg)("em",{parentName:"li"},"2 byte")," (u16) length of the string in bytes and ",(0,l.yg)("em",{parentName:"li"},"n byte")," string value (utf8 encoded string)")))))),(0,l.yg)("h3",{id:"statsd"},"statsd"),(0,l.yg)("p",null,"The same as the influx, the ",(0,l.yg)("inlineCode",{parentName:"p"},"statsd")," codec translates a single ",(0,l.yg)("inlineCode",{parentName:"p"},"statsd")," measurement into a structured format. The structure is as follows:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-text"},"sam:7|c|@0.1\n")),(0,l.yg)("p",null,"Translates to:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "c",\n  "metric": "sam",\n  "value": 7,\n  "sample_rate": 0.1\n}\n')),(0,l.yg)("p",null,"The following types are supported:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"c")," for ",(0,l.yg)("inlineCode",{parentName:"li"},"counter")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"ms")," for ",(0,l.yg)("inlineCode",{parentName:"li"},"timing")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"g")," for ",(0,l.yg)("inlineCode",{parentName:"li"},"gauge")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"h")," for ",(0,l.yg)("inlineCode",{parentName:"li"},"histogram")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"s")," for ",(0,l.yg)("inlineCode",{parentName:"li"},"sets"))),(0,l.yg)("p",null,"For ",(0,l.yg)("strong",{parentName:"p"},"gauge")," there is also the field ",(0,l.yg)("inlineCode",{parentName:"p"},"action")," which might be ",(0,l.yg)("inlineCode",{parentName:"p"},"add")," if the value was prefixed with a ",(0,l.yg)("inlineCode",{parentName:"p"},"+"),", or ",(0,l.yg)("inlineCode",{parentName:"p"},"sub")," if the value was prefixed with a ",(0,l.yg)("inlineCode",{parentName:"p"},"-")),(0,l.yg)("h3",{id:"yaml"},"yaml"),(0,l.yg)("p",null,"En- and decodes ",(0,l.yg)("a",{parentName:"p",href:"https://yaml.org"},"YAML"),"."),(0,l.yg)("h3",{id:"syslog"},"syslog"),(0,l.yg)("p",null,"En- and decodes syslog messages (both, the standard IETF format and the old BSD format).\nA syslog message following BSD format as follows:              "),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-text"},"<13>Jan  5 15:33:03 74794bfb6795 root[8539]: i am foobar\n")),(0,l.yg)("p",null,"get translates to:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "severity": "notice",\n  "facility": "user",\n  "hostname": "74794bfb6795",\n  "appname": "root",\n  "msg": "i am foobar",\n  "procid": 8539,\n  "msgid": null,\n  "protocol": "RFC3164",\n  "protocol_version": null,\n  "structured_data": null,\n  "timestamp": 1609860783000000000\n}\n')),(0,l.yg)("p",null,"Syslog message following IETF standard as follows:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-text"},'<165>1 2021-03-18T20:30:00.123Z mymachine.example.com evntslog - ID47 [exampleSDID@32473 iut=\\"3\\" eventSource=\\"Application\\" eventID=\\"1011\\"] BOMAn application event log entry..."\n')),(0,l.yg)("p",null,"get translates to:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "severity": "notice",\n  "facility": "local4",\n  "hostname": "mymachine.example.com",\n  "appname": "evntsog",\n  "msg": "BOMAn application event log entry...",\n  "procid": null,\n  "msgid": "ID47",\n  "protocol": "RFC5424",\n  "protocol_version": 1,\n  "structured_data": {\n              "exampleSDID@32473" :\n              [\n                {"iut": "3"},\n                {"eventSource": "Application"},\n                {"eventID": "1011"}\n              ]\n            },\n  "timestamp": 1616099400123000000\n}\n')),(0,l.yg)("admonition",{type:"note"},(0,l.yg)("p",{parentName:"admonition"},"a malformed syslog message is treated under ",(0,l.yg)("inlineCode",{parentName:"p"},"3164")," protocol and entire string goes to the ",(0,l.yg)("inlineCode",{parentName:"p"},"msg")," of result object.")))}d.isMDXComponent=!0}}]);