"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[806],{48021:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var s=t(58168),i=(t(96540),t(15680));t(40281);const a={},o="Syslog UDP",l={unversionedId:"guides/old/syslog_udp/index",id:"version-0.12/guides/old/syslog_udp/index",title:"Syslog UDP",description:"The syslog udp example is demonstrate a number things:",source:"@site/versioned_docs/version-0.12/guides/old/syslog_udp/index.md",sourceDirName:"guides/old/syslog_udp",slug:"/guides/old/syslog_udp/",permalink:"/docs/0.12/guides/old/syslog_udp/",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.12/guides/old/syslog_udp/index.md",tags:[],version:"0.12",frontMatter:{},sidebar:"indexSidebar",previous:{title:"Logstash",permalink:"/docs/0.12/guides/old/logstash/"},next:{title:"Syslog UDP with DNS",permalink:"/docs/0.12/guides/old/syslog_udp_dns/"}},r={},d=[{value:"Setup",id:"setup",level:2},{value:"Environment",id:"environment",level:2},{value:"Business Logic",id:"business-logic",level:2},{value:"Testing",id:"testing",level:2}],g={toc:d},p="wrapper";function m(e){let{components:n,...a}=e;return(0,i.yg)(p,(0,s.A)({},g,a,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"syslog-udp"},"Syslog UDP"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"syslog udp")," example is demonstrate a number things:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Encoding data in the ",(0,i.yg)("inlineCode",{parentName:"li"},"syslog")," format."),(0,i.yg)("li",{parentName:"ol"},"Sending data over ",(0,i.yg)("inlineCode",{parentName:"li"},"UDP"),"."),(0,i.yg)("li",{parentName:"ol"},"Receiving data over ",(0,i.yg)("inlineCode",{parentName:"li"},"UDP"),"."),(0,i.yg)("li",{parentName:"ol"},"Decoding ",(0,i.yg)("inlineCode",{parentName:"li"},"syslog")," formatted data.")),(0,i.yg)("p",null,"For digestion it is entirely self-contained inside a single tremor instance using multiple parallel pipelines, sinks and sources."),(0,i.yg)("h2",{id:"setup"},"Setup"),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"All the code here is available in the ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/tremor-rs/tremor-www/tree/main/docs/recipes/syslog_udp"},"git repository")," as well and can be run with ",(0,i.yg)("inlineCode",{parentName:"p"},"docker compose up"),".")),(0,i.yg)("h2",{id:"environment"},"Environment"),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(14911).A},"sources and sinks")," we use are:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"metronome")," source - to generate data in one second intervals."),(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"udp")," sink - to send the data over ",(0,i.yg)("inlineCode",{parentName:"li"},"UDP"),"."),(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"udp")," source - to receive data via ",(0,i.yg)("inlineCode",{parentName:"li"},"UDP"),"."),(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"stdout")," sink - to display data decoded and re-formatted as ",(0,i.yg)("inlineCode",{parentName:"li"},"JSON"),".")),(0,i.yg)("p",null,"In addition we have two pipelines."),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(19592).A},"producer")," pipeline takes the tick from metronome and generates a syslog message. It is only handling message rewriting."),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(19592).A},"consumer")," pipeline takes the syslog message and forwards it. It is a passthrough pipeline."),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{target:"_blank",href:t(5600).A},"binding")," expresses those relations and gives the graph of onramp, pipeline and offramp. We hare left with those two workflows:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"metronome -> producer -> syslog-udp-out\n\nsyslog-udp-in -> consumer -> stdout-output\n")),(0,i.yg)("p",null,"Finally the ",(0,i.yg)("a",{target:"_blank",href:t(22306).A},"mapping")," instantiates the binding with the given name and instance variable to activate the elements of the binding."),(0,i.yg)("h2",{id:"business-logic"},"Business Logic"),(0,i.yg)("p",null,"The only interesting part to look at is the event rewriting, this uses an example syslog message and adds the ",(0,i.yg)("inlineCode",{parentName:"p"},"event.id")," as a ",(0,i.yg)("inlineCode",{parentName:"p"},"structured_data")," field."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tremor"},'select {\n  "severity": "notice",\n  "facility": "local4",\n  "hostname": "example.com",\n  "appname": "evntsog",\n  "msg": "BOMAn application event log entry...",\n  "procid": null,\n  "msgid": "ID47",\n  "protocol": "RFC5424",\n  "protocol_version": 1,\n  "structured_data": {\n              "exampleSDID@32473" :\n              [\n                {"eventSource": "Tremor"},\n                {"eventID": "#{ event.id }"}\n              ]\n            },\n  "timestamp": event.ingest_ns\n} from in into out\n')),(0,i.yg)("h2",{id:"testing"},"Testing"),(0,i.yg)("p",null,"If using the CLI, you can run the server using config artifacts and see a log message triggered by the metronome every\nsecond being transformed by the pipeline into json and sent to stdout:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-shell-session"},'$ tremor server run -f docs/recipes/14_syslog_udp/etc/tremor/config/*\ntremor version: 0.11.12 heads/v0.11.12:77792d92a9e5788eb221b1e64cde4d2dce756340\n...\n>> {"hostname":"example.com","severity":"notice","facility":"local4","timestamp":1651666687465441000,"protocol":"RFC5424","protocol_version":1,"appname":"evntsog","msgid":"ID47","structured_data":{"exampleSDID@32473":[{"eventSource":"Tremor"},{"eventID":"0"}]},"procid":null,"msg":"BOMAn application event log entry..."}\n>> {"hostname":"example.com","severity":"notice","facility":"local4","timestamp":1651666688468303000,"protocol":"RFC5424","protocol_version":1,"appname":"evntsog","msgid":"ID47","structured_data":{"exampleSDID@32473":[{"eventSource":"Tremor"},{"eventID":"1"}]},"procid":null,"msg":"BOMAn application event log entry..."}\n')),(0,i.yg)("p",null,"Since the config enables a syslog receiver on port 12201, you should be able to send custom syslog messages with the\n",(0,i.yg)("inlineCode",{parentName:"p"},"logger")," command."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-shell-session"},'$ logger -d -n 127.0.0.1 -P 12201 "Weeeeh. It works :D"\n')),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"NOTE:")," If you are running the recipe inside a docker container, execute the command inside the container using\n",(0,i.yg)("inlineCode",{parentName:"p"},"docker exec"),". If you are running using the CLI, leave tremor running and execute this in a different terminal window."),(0,i.yg)("p",null,"You should be able to see a message similar to this in the tremor output."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'>> {"hostname":"neptune","severity":"notice","facility":"user","timestamp":1651671807829230000,\n    "protocol":"RFC5424", "protocol_version":1,"appname":"sandipb","msgid":null,\n    "structured_data":{"timeQuality":[{"tzKnown":"1"},{"isSynced":"1"},{"syncAccuracy":"153500"}]},\n    "procid":null, "msg":"Weeeeh. It works :D"}\n')))}m.isMDXComponent=!0},14911:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/00_ramps-161b131f6ede770706ea7e30fe0fb2cf.yaml"},5600:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/01_binding-9fd3773478862fcdc641a6550c31df6a.yaml"},22306:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/02_mapping-87bbf82480a24d4f084bf711805395d1.yaml"},19592:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/consumer-a5bc721242b579503e73a6e7cda4ec32.trickle"}}]);