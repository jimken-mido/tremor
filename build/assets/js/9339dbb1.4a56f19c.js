"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[3150],{86046:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>m});var o=t(58168),r=(t(96540),t(15680)),i=t(40281);const a={sidebar_label:"metronome (Periodic messages)",sidebar_position:1},c="The metronome Connector",s={unversionedId:"reference/connectors/metronome",id:"version-0.12/reference/connectors/metronome",title:"The metronome Connector",description:"The metronome connector generates a periodic flow of events at a configured interval.",source:"@site/versioned_docs/version-0.12/reference/connectors/metronome.md",sourceDirName:"reference/connectors",slug:"/reference/connectors/metronome",permalink:"/docs/0.12/reference/connectors/metronome",draft:!1,editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/versioned_docs/version-0.12/reference/connectors/metronome.md",tags:[],version:"0.12",sidebarPosition:1,frontMatter:{sidebar_label:"metronome (Periodic messages)",sidebar_position:1},sidebar:"indexSidebar",previous:{title:"metrics (Tremor metrics)",permalink:"/docs/0.12/reference/connectors/metrics"},next:{title:"otel (Open Telemetry)",permalink:"/docs/0.12/reference/connectors/otel"}},l={},m=[{value:"Configuration",id:"configuration",level:2},{value:"Illustrative example",id:"illustrative-example",level:2},{value:"Exercises",id:"exercises",level:2}],p={toc:m},d="wrapper";function u(e){let{components:n,...t}=e;return(0,r.yg)(d,(0,o.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"the-metronome-connector"},"The ",(0,r.yg)("inlineCode",{parentName:"h1"},"metronome")," Connector"),(0,r.yg)("p",null,"The metronome connector generates a periodic flow of events at a configured interval."),(0,r.yg)("p",null,"The connector is particularly useful when using transient or persistent state via the\n",(0,r.yg)("a",{parentName:"p",href:"./kv"},(0,r.yg)("inlineCode",{parentName:"a"},"kv"))," connector or via the state mechanism to evict and remove ",(0,r.yg)("inlineCode",{parentName:"p"},"stale")," data\nthat is no longer current or relevant to the running system."),(0,r.yg)("p",null,"The connector is also sueful for driving periodic events when used in concert with\nother connectors or pipelines to periodically poll to retrieve meta data updates to\nmerge with in-memory state in the current solution. "),(0,r.yg)("h2",{id:"configuration"},"Configuration"),(0,r.yg)("p",null,"An ",(0,r.yg)("inlineCode",{parentName:"p"},"interval")," in milliseconds is required to use the metronome"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},'  define connector every_second from metronome\n  with\n     config = {"interval": 1000}\n  end;\n')),(0,r.yg)("h2",{id:"illustrative-example"},"Illustrative example"),(0,r.yg)("p",null,"A simple tremor application that issues a single metronome event and uses it to\ntrigger an exit of the tremor runtime - a common quiescence pattern in our tests\ndriven by the metronome in this illustration."),(0,r.yg)("p",null,"A high level summary of this flow's logic:"),(0,r.yg)(i.K,{chart:"graph LR\n    A{Metronome} --\x3e|every second| B(triggered events)\n    B --\x3e|passthrough| C{Standard Output}\n    B --\x3e|stop server| D{Exit Runtime}",mdxType:"Mermaid"}),(0,r.yg)("p",null,"The application source for this example:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-tremor"},'define flow main\nflow\n  use tremor::connectors;\n  use integration;\n\n  # Define our periodic source of events\n  define connector every_second from metronome\n  with\n    config = {"interval": 1000}\n  end;\n \n  # Triggered for every periodic event from our metronome \n  define pipeline main\n  pipeline\n    select "triggered" from in into out;\n  end;\n\n  # An `exit` event used in integration tests to stop tremor\n  define pipeline exit\n  pipeline    \n    select { "exit": 0, } from in into out;\n  end;\n\n  create connector exit from connectors::exit;\n  create connector file from integration::write_file;\n  create connector metronome;\n\n  create pipeline main;\n  create pipeline exit;\n\n  connect /connector/every_second to /pipeline/main;\n  connect /connector/every_second to /pipeline/exit;\n  connect /pipeline/main to /connector/file;\n  connect /pipeline/exit to /connector/exit;\nend;\n\ndeploy flow main;\n')),(0,r.yg)("h2",{id:"exercises"},"Exercises"),(0,r.yg)("p",null,"To further explore the ",(0,r.yg)("inlineCode",{parentName:"p"},"metronome"),":"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Modify the application to stop after N events by introducing a counter"),(0,r.yg)("li",{parentName:"ul"},"Modify the application to trigger a HTTP ",(0,r.yg)("inlineCode",{parentName:"li"},"GET")," request and serialize the response to a log file"),(0,r.yg)("li",{parentName:"ul"},"Replace the ",(0,r.yg)("inlineCode",{parentName:"li"},"metronome")," with a ",(0,r.yg)("inlineCode",{parentName:"li"},"crononome")," for periodic scheduled calendar driven events")))}u.isMDXComponent=!0}}]);