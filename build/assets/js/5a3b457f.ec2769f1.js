"use strict";(self.webpackChunktremor_website=self.webpackChunktremor_website||[]).push([[4204],{45155:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=t(58168),i=(t(96540),t(15680));const r={title:"Case Study - Modularity, Oh My",tags:["case-study","wayfair"],author:"The Tremor Team",author_url:"https://github.com/tremor-rs",author_image_url:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4",image:"./media/wayfair.png",draft:!1,hide_table_of_contents:!1},o="Modularity, Oh My",s={permalink:"/blog/2021/11/06/modularity",editUrl:"https://github.com/tremor-rs/tremor-www/tree/main/blog/2021-11-06-modularity.md",source:"@site/blog/2021-11-06-modularity.md",title:"Case Study - Modularity, Oh My",description:"Identified Need",date:"2021-11-06T00:00:00.000Z",formattedDate:"November 6, 2021",tags:[{label:"case-study",permalink:"/blog/tags/case-study"},{label:"wayfair",permalink:"/blog/tags/wayfair"}],readingTime:4.315,hasTruncateMarker:!1,authors:[{name:"The Tremor Team",url:"https://github.com/tremor-rs",imageURL:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4"}],frontMatter:{title:"Case Study - Modularity, Oh My",tags:["case-study","wayfair"],author:"The Tremor Team",author_url:"https://github.com/tremor-rs",author_image_url:"https://avatars.githubusercontent.com/u/60009416?s=200&v=4",image:"./media/wayfair.png",draft:!1,hide_table_of_contents:!1},prevItem:{title:"Case Study - Multi-Participant Transaction Orchestration",permalink:"/blog/2021/11/07/search"},nextItem:{title:"Case Study - Kubernetes and Tremor Sidecars",permalink:"/blog/2021/11/05/kubernetes-sidecars"}},l={image:t(21697).A,authorsImageUrls:[void 0]},d=[{value:"Identified Need",id:"identified-need",level:2},{value:"Required Outcome",id:"required-outcome",level:2},{value:"Characteristics",id:"characteristics",level:3},{value:"Modular scripting",id:"modular-scripting",level:3},{value:"Modularity in the query language",id:"modularity-in-the-query-language",level:3},{value:"Modularity in the deployment language",id:"modularity-in-the-deployment-language",level:3},{value:"Solution",id:"solution",level:2},{value:"Conclusion",id:"conclusion",level:2}],u={toc:d},m="wrapper";function c(e){let{components:n,...t}=e;return(0,i.yg)(m,(0,a.A)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"identified-need"},"Identified Need"),(0,i.yg)("p",null,"The adoption growth of tremor inside Wayfair is such that we have\nproduction customers with 3.5 years of experience operating tremor in\nproduction with very large, complex tremor-based services - and fresh\ndemands from new domains such as Search - whose requirements for\nmulti-participant transaction orchestration are driving enhancements to\nqualify of service, guaranteed delivery and circuit breaker capabilities\nwithin tremor\u2019s core processing engine."),(0,i.yg)("p",null,"Some usage patterns are becoming common enough that sharing tremor\napplication logic across teams, across organizations, and across domains\nis now common. For example - tremor has good support for HTTP based\ninteractions and already interfaces with a number of HTTP-based and REST\nAPIs, and it can expose HTTP-based interfaces to participants and act as\na REST-based or HTTP-based service. Many of these services share the\nsame needs around handling HTTP errors and routing errors and alerts."),(0,i.yg)("p",null,"At the event flow or query level - similar levels of sophistication are\nemerging in the installed user base."),(0,i.yg)("h2",{id:"required-outcome"},"Required Outcome"),(0,i.yg)("p",null,"Expand tremor\u2019s domain specific languages to support modularity,\nstarting with the scripting language but extending into the query\nlanguage to maximise reuse of user-defined processing logic."),(0,i.yg)("h3",{id:"characteristics"},"Characteristics"),(0,i.yg)("p",null,"Provide standard mechanism and syntax to discover, reference and consume\nfunctional units of logic that can be shared by all tremor domain\nspecific languages."),(0,i.yg)("p",null,"A new lexical preprocessing phase has been introduced allowing source to\nbe packaged within a modular set of paths through a ",(0,i.yg)("inlineCode",{parentName:"p"},"TREMOR_PATH")," environment\nvariable. Since V0.8 of tremor the scripting and query languages both\nsupport modules, and share the same module syntax and semantics."),(0,i.yg)("p",null,"The tremor API was upgraded to supported preprocessed or non-modular\nsource so that no API changes were required to extend the deployment\nmechanisms to support modularity."),(0,i.yg)("h3",{id:"modular-scripting"},"Modular scripting"),(0,i.yg)("p",null,"In a nutshell - this added support for user defined constants and user\ndefined functions."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tremor",metastring:'title="my_mod.tremor"',title:'"my_mod.tremor"'},"# Tail recursive implementation of fibonacci\n#\nfn fib_(a, b, n) of\n  case (a, b, n) when n > 0 => recur(b, a + b, n - 1)\n  default => a\nend;\n\nfn fib(n) with\n  fib_(0, 1, n)\nend;\n")),(0,i.yg)("p",null,"The module can be loaded via the module path and used in other script or query sources:  "),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-trickle",metastring:'title="fib.trickle"',title:'"fib.trickle"'},"# A streaming fibonacci service*\n\ndefine script fibber\nscript\n  use my_mod;\n    my_mod::fib(event)\nend;\n\ncreate script fib from fibber;\n\nselect event from in into fib;\n\nselect event from fib into out;\n")),(0,i.yg)("p",null,"Modules can be file-based, or defined inline in the scripting or query\nlanguage. A standard set of system modules is provided by tremor out of the box."),(0,i.yg)("p",null,(0,i.yg)("a",{parentName:"p",href:"https://www.tremor.rs/docs/tremor-script/modules"},"Tremor Modules"),"  "),(0,i.yg)("h3",{id:"modularity-in-the-query-language"},"Modularity in the query language"),(0,i.yg)("p",null,"In the query language windows, scripts and pluggable operators may be\ndefined and shared across queries."),(0,i.yg)("p",null,"There is an RFC for modular sub-query to allow query sub-graphs to be\ndefined and shared which is being delivered as part of a tremor LFX\nmentorship."),(0,i.yg)("h3",{id:"modularity-in-the-deployment-language"},"Modularity in the deployment language"),(0,i.yg)("p",null,"Modular deployments through replacing the YAML configuration syntax with\na deployment language will embed the modular query language, which in turn\nembeds the modular scripting language.  "),(0,i.yg)("p",null,"This work is under development and will span multiple releases - but it\nis being designed in such a way that as clustering capabilities are added to tremor, that\nclustered or  distributed deployments will be modularly composable by end users using\nthe same  tooling as the other DSLs within tremor."),(0,i.yg)("h2",{id:"solution"},"Solution"),(0,i.yg)("p",null,"The support for modularity is thematic. The scripting language now\nsupports a functional programming paradigm and file-based or nested\ninline modules. The query language can embed modular scripts using the\nsame module mechanism and definitions in the query language are also\nmodular."),(0,i.yg)("p",null,"Modular sub-query and the introduction of the deployment language are\nplanned and in progress and will extend modularity to the administration\nof running tremor nodes."),(0,i.yg)("p",null,"And, in the fullness of time, clustering will further extend modularity\nin tremor to maximize operator and tremor developer productivity through\nefficient reuse and sharing of common tasks."),(0,i.yg)("p",null,"The first set of connectivity to benefit from modularity is the support\nfor CNCF OpenTelemetry. This is the first set of tremor connectors to be\ndelivered that ships with its own set of modules designed to make\ndesigning OpenTelemetry based services in tremor easier."),(0,i.yg)("h2",{id:"conclusion"},"Conclusion"),(0,i.yg)("p",null,"As tremor grows into new domains, and the algorithm and solution\ncomplexity of traditional production domains for tremor increase in\nsophistication, size, complexity, the subject of modularity has evolved\nand new demands continue to emerge.  "),(0,i.yg)("p",null,"We expect the ",(0,i.yg)("inlineCode",{parentName:"p"},"modularity")," theme to be long-lived, but its origins\nderive from production needs. When tremor was developed the user defined\nlogic was small, relatively simple and applications built with tremor\nwere fairly monolithic.  "),(0,i.yg)("p",null,"Today, multi-pipeline and medium to large tremor-based applications are\ncommon. And adoption of the modular scripting and query language\nprimitives is now driving larger and more sophisticated use cases."),(0,i.yg)("p",null,"Another dimension of modularity is the ongoing expansion of connectivity\nin tremor. Modularity here reflects a different production-driven need (\nand a few maintainer conveniences ). A plugin development kit is being\ndeveloped that will allow connectors and other plugins to be developed\nin separately managed and maintained projects. This in turn allows the\ncore of tremor to be managed independently of connectivity."))}c.isMDXComponent=!0},21697:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/wayfair-b0bafac5cf230fcd5e29c8cb4560c334.png"}}]);